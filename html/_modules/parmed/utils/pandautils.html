

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>parmed.utils.pandautils &mdash; ParmEd  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> ParmEd
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.3319.g7a6168d
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../topologyobjects.html">Core classes used to represent topologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">The core Structure class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dimensional_analysis.html">Working with units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../readwrite.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../amber.html">The Amber file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../charmm.html">The CHARMM file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gromacs.html">The GROMACS file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rosetta.html">PyRosetta Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parmed.html">Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parmed.html#using-xparmed">Using <code class="docutils literal notranslate"><span class="pre">xparmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parmed_api.html">The ParmEd API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openmm.html">OpenMM Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualization.html">Visualization Functionality</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ParmEd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../utils.html">parmed.utils</a> &raquo;</li>
        
      <li>parmed.utils.pandautils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for parmed.utils.pandautils</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; A collection of utilities for use with Pandas objects &quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">pd</span> <span class="o">=</span> <span class="kc">None</span>
<span class="kn">from</span> <span class="nn">parmed.exceptions</span> <span class="kn">import</span> <span class="n">ParameterWarning</span>
<span class="kn">from</span> <span class="nn">parmed.utils.six.moves</span> <span class="kn">import</span> <span class="nb">zip</span>
<span class="kn">from</span> <span class="nn">parmed.utils.six</span> <span class="kn">import</span> <span class="n">iteritems</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Utility function for generating a DataFrame based on a collection of items.</span>
<span class="c1"># The passed object must have an `atoms` attribute</span>

<div class="viewcode-block" id="create_dataframe"><a class="viewcode-back" href="../../../api/parmed/parmed.utils.pandautils.html#parmed.utils.pandautils.create_dataframe">[docs]</a><span class="k">def</span> <span class="nf">create_dataframe</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Creates a pandas.DataFrame object from the current instance</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dataframe : :class:`pandas.DataFrame`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The DataFrame will be over all atoms. The columns will be the attributes</span>
<span class="sd">    of the atom (as well as its containing residue). Some columns will</span>
<span class="sd">    *always* exist. Others will only exist if those attributes have been set</span>
<span class="sd">    on the Atom instances (see the :class:`Atom` docs for possible</span>
<span class="sd">    attributes and their meaning). The columns that will always be present</span>
<span class="sd">    are:</span>

<span class="sd">        - number : int</span>
<span class="sd">        - name : str</span>
<span class="sd">        - type : str</span>
<span class="sd">        - atomic_number : int</span>
<span class="sd">        - charge : float</span>
<span class="sd">        - mass : float</span>
<span class="sd">        - nb_idx : int</span>
<span class="sd">        - solvent_radius : float</span>
<span class="sd">        - screen : float</span>
<span class="sd">        - occupancy : float</span>
<span class="sd">        - bfactor : float</span>
<span class="sd">        - altloc : str</span>
<span class="sd">        - tree : str</span>
<span class="sd">        - join : int</span>
<span class="sd">        - irotat : int</span>
<span class="sd">        - rmin : float</span>
<span class="sd">        - epsilon : float</span>
<span class="sd">        - rmin_14 : float</span>
<span class="sd">        - epsilon_14 : float</span>
<span class="sd">        - resname : str (name of the containing residue)</span>
<span class="sd">        - resid : int (Sequential index of the containing residue)</span>
<span class="sd">        - resnum : int (original residue number in the input structure)</span>
<span class="sd">        - chain : str (chain ID that the containing residue belongs to)</span>

<span class="sd">    The following attributes are optionally present if they were present in</span>
<span class="sd">    the original file defining the structure:</span>

<span class="sd">        - xx : float (x-coordinate position)</span>
<span class="sd">        - xy : float (y-coordinate position)</span>
<span class="sd">        - xz : float (z-coordinate position)</span>
<span class="sd">        - vx : float (x-coordinate velocity)</span>
<span class="sd">        - vy : float (y-coordinate velocity)</span>
<span class="sd">        - vz : float (z-coordinate velocity)</span>
<span class="sd">        - type_idx : int (integer type index for AMOEBA)</span>
<span class="sd">        - class_idx : int (integer class type index for AMOEBA)</span>
<span class="sd">        - multipole_111 : float (Monopole)</span>
<span class="sd">        - multipole_211 : float (1,1 Dipole component)</span>
<span class="sd">        - multipole_212 : float (1,2 Dipole component)</span>
<span class="sd">        - multipole_222 : float (2,2 Dipole component)</span>
<span class="sd">        - multipole_411 : float (1,1 Quadrupole component)</span>
<span class="sd">        - multipole_412 : float (1,2 Quadrupole component)</span>
<span class="sd">        - multipole_422 : float (2,2 Quadrupole component)</span>
<span class="sd">        - multipole_413 : float (1,3 Quadrupole component)</span>
<span class="sd">        - multipole_423 : float (2,3 Quadrupole component)</span>
<span class="sd">        - multipole_433 : float (3,3 Quadrupole component)</span>
<span class="sd">        - polarizability : float (dipole polarizability)</span>
<span class="sd">        - vdw_parent : int (index of the vdW parent atom of this atom)</span>
<span class="sd">        - U11 : float (U[1][1] of anisotropic b-factor tensor)</span>
<span class="sd">        - U22 : float (U[2][2] of anisotropic b-factor tensor)</span>
<span class="sd">        - U33 : float (U[3][3] of anisotropic b-factor tensor)</span>
<span class="sd">        - U12 : float (U[1][2] of anisotropic b-factor tensor)</span>
<span class="sd">        - U13 : float (U[1][3] of anisotropic b-factor tensor)</span>
<span class="sd">        - U23 : float (U[2][3] of anisotropic b-factor tensor)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;pandas is not available; cannot create a pandas &#39;</span>
                          <span class="s1">&#39;DataFrame from this Structure&#39;</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">atoms</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">atoms</span>

    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">number</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">type</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;atomic_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">atomic_number</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;charge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">charge</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;nb_idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">nb_idx</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;solvent_radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">solvent_radius</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;screen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">screen</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">occupancy</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;bfactor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">bfactor</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;altloc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">altloc</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;tree&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">tree</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;join&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">join</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;irotat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">irotat</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;rmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">rmin</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;epsilon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">epsilon</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;rmin_14&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">rmin_14</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;epsilon_14&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">epsilon_14</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;resname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;resid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">idx</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;resnum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;chain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">chain</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;segid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">segid</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>

    <span class="c1"># Now for optional attributes</span>
    <span class="c1"># Coordinates</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">[[</span><span class="n">atom</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">xy</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">xz</span><span class="p">]</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">],</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;xz&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="c1"># Velocities</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">[[</span><span class="n">atom</span><span class="o">.</span><span class="n">vx</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">vy</span><span class="p">,</span> <span class="n">atom</span><span class="o">.</span><span class="n">vz</span><span class="p">]</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">],</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vx&#39;</span><span class="p">,</span> <span class="s1">&#39;vy&#39;</span><span class="p">,</span> <span class="s1">&#39;vz&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vels</span><span class="p">)</span>
    <span class="c1"># AMOEBA LJ type</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;type_idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">type_idx</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># AMOEBA class type</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;class_idx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">class_idx</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># AMOEBA multipoles</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">multipoles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">multipoles</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">],</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;multipole_111&#39;</span><span class="p">,</span> <span class="s1">&#39;multipole_211&#39;</span><span class="p">,</span> <span class="s1">&#39;multipole_212&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;multipole_222&#39;</span><span class="p">,</span> <span class="s1">&#39;multipole_411&#39;</span><span class="p">,</span> <span class="s1">&#39;multipole_412&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;multipole_422&#39;</span><span class="p">,</span> <span class="s1">&#39;multipole_413&#39;</span><span class="p">,</span> <span class="s1">&#39;multipole_423&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;multipole_433&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">multipoles</span><span class="p">)</span>
    <span class="c1"># AMOEBA polarizabilities</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;polarizability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">polarizability</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># AMOEBA vdw parent atom</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span><span class="p">[</span><span class="s1">&#39;vdw_parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">vdw_parent</span><span class="o">.</span><span class="n">idx</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># anisotropic b-factors</span>
    <span class="n">none6</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>
    <span class="n">anisos</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">anisou</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">aniso</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">anisos</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">aniso</span><span class="p">,</span> <span class="s1">&#39;tolist&#39;</span><span class="p">):</span>
            <span class="n">anisos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aniso</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">all_nones</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">aniso</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">anisos</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">aniso</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">anisos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">none6</span>
        <span class="k">elif</span> <span class="n">all_nones</span><span class="p">:</span>
            <span class="n">all_nones</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_nones</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">anisos</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;U11&#39;</span><span class="p">,</span> <span class="s1">&#39;U22&#39;</span><span class="p">,</span> <span class="s1">&#39;U33&#39;</span><span class="p">,</span> <span class="s1">&#39;U12&#39;</span><span class="p">,</span> <span class="s1">&#39;U13&#39;</span><span class="p">,</span> <span class="s1">&#39;U23&#39;</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="load_dataframe"><a class="viewcode-back" href="../../../api/parmed/parmed.utils.pandautils.html#parmed.utils.pandautils.load_dataframe">[docs]</a><span class="k">def</span> <span class="nf">load_dataframe</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads a DataFrame into the current object, setting atomic properties based</span>
<span class="sd">    on the entries of the DataFrame.  Supported atomic properties are:</span>

<span class="sd">        - number : int</span>
<span class="sd">        - name : str</span>
<span class="sd">        - type : str</span>
<span class="sd">        - atomic_number : int</span>
<span class="sd">        - charge : float</span>
<span class="sd">        - mass : float</span>
<span class="sd">        - nb_idx : int</span>
<span class="sd">        - solvent_radius : float</span>
<span class="sd">        - screen : float</span>
<span class="sd">        - occupancy : float</span>
<span class="sd">        - bfactor : float</span>
<span class="sd">        - altloc : str</span>
<span class="sd">        - tree : str</span>
<span class="sd">        - join : int</span>
<span class="sd">        - irotat : int</span>
<span class="sd">        - rmin : float</span>
<span class="sd">        - epsilon : float</span>
<span class="sd">        - rmin_14 : float</span>
<span class="sd">        - epsilon_14 : float</span>
<span class="sd">        - xx : float (x-coordinate position)</span>
<span class="sd">        - xy : float (y-coordinate position)</span>
<span class="sd">        - xz : float (z-coordinate position)</span>
<span class="sd">        - vx : float (x-coordinate velocity)</span>
<span class="sd">        - vy : float (y-coordinate velocity)</span>
<span class="sd">        - vz : float (z-coordinate velocity)</span>
<span class="sd">        - type_idx : int (integer type index for AMOEBA)</span>
<span class="sd">        - class_idx : int (integer class type index for AMOEBA)</span>
<span class="sd">        - multipole_111 : float (Monopole)</span>
<span class="sd">        - multipole_211 : float (1,1 Dipole component)</span>
<span class="sd">        - multipole_212 : float (1,2 Dipole component)</span>
<span class="sd">        - multipole_222 : float (2,2 Dipole component)</span>
<span class="sd">        - multipole_411 : float (1,1 Quadrupole component)</span>
<span class="sd">        - multipole_412 : float (1,2 Quadrupole component)</span>
<span class="sd">        - multipole_422 : float (2,2 Quadrupole component)</span>
<span class="sd">        - multipole_413 : float (1,3 Quadrupole component)</span>
<span class="sd">        - multipole_423 : float (2,3 Quadrupole component)</span>
<span class="sd">        - multipole_433 : float (3,3 Quadrupole component)</span>
<span class="sd">        - polarizability : float (dipole polarizability)</span>
<span class="sd">        - vdw_parent : int (index of the vdW parent atom of this atom)</span>
<span class="sd">        - segid : segment ID (similar to chain, but for CHARMM)</span>
<span class="sd">        - U11 : float (U[1][1] of anisotropic b-factor tensor)</span>
<span class="sd">        - U22 : float (U[2][2] of anisotropic b-factor tensor)</span>
<span class="sd">        - U33 : float (U[3][3] of anisotropic b-factor tensor)</span>
<span class="sd">        - U12 : float (U[1][2] of anisotropic b-factor tensor)</span>
<span class="sd">        - U13 : float (U[1][3] of anisotropic b-factor tensor)</span>
<span class="sd">        - U23 : float (U[2][3] of anisotropic b-factor tensor)</span>

<span class="sd">    The resname, resid, chain, and resnum attributes are ignored. Other</span>
<span class="sd">    attributes emit a ParameterWarning</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">atoms</span>

    <span class="k">def</span> <span class="nf">set_attribute</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set the attribute list from the data &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data does not match length of atoms list&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">set_residue_attr</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data does not match length of atoms list&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">multipoles</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="n">anisous</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;number&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;atomic_number&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;atomic_number&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;charge&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;charge&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;mass&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;nb_idx&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;nb_idx&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;solvent_radius&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;solvent_radius&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;screen&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;screen&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;occupancy&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;occupancy&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;bfactor&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;bfactor&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;altloc&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;altloc&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;tree&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;tree&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;join&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;join&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;irotat&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;irotat&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;rmin&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;rmin&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;rmin_14&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;rmin_14&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;epsilon_14&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;epsilon_14&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;xx&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;xz&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;xz&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;vx&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;vx&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;vy&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;vy&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;vz&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;vz&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;type_idx&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;type_idx&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;class_idx&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;class_idx&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;vdw_parent&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;vdw_parent length not equal to natom&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">parent</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">vdw_parent</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;polarizability&#39;</span><span class="p">:</span>
            <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;polarizability&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_111&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_211&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_212&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_213&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_411&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_412&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_422&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_413&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_423&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;multipole_433&#39;</span><span class="p">:</span>
            <span class="n">multipoles</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;U11&#39;</span><span class="p">:</span>
            <span class="n">anisous</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;U22&#39;</span><span class="p">:</span>
            <span class="n">anisous</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;U33&#39;</span><span class="p">:</span>
            <span class="n">anisous</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;U12&#39;</span><span class="p">:</span>
            <span class="n">anisous</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;U13&#39;</span><span class="p">:</span>
            <span class="n">anisous</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;U23&#39;</span><span class="p">:</span>
            <span class="n">anisous</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;resname&#39;</span><span class="p">,</span> <span class="s1">&#39;resid&#39;</span><span class="p">,</span> <span class="s1">&#39;resnum&#39;</span><span class="p">,</span> <span class="s1">&#39;chain&#39;</span><span class="p">,</span> <span class="s1">&#39;segid&#39;</span><span class="p">):</span>
            <span class="n">set_residue_attr</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Atomic property </span><span class="si">%s</span><span class="s1"> not recognized&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">,</span>
                          <span class="n">ParameterWarning</span><span class="p">)</span>

    <span class="c1"># Now combine the multipoles and anisous if they are all specified</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">anisous</span><span class="p">:</span>
        <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;anisou&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">anisous</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">multipoles</span><span class="p">:</span>
        <span class="n">set_attribute</span><span class="p">(</span><span class="s1">&#39;multipoles&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">multipoles</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Jason Swails

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>