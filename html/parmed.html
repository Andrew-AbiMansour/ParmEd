

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using parmed &mdash; ParmEd  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The API for ParmEd Command-line Utilities" href="parmed_api.html" />
    <link rel="prev" title="Seeding OpenMM Simulations with PyRosetta and ParmEd" href="omm_rosetta.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> ParmEd
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.3319.g7a6168d
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="topologyobjects.html">Core classes used to represent topologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">The core Structure class</a></li>
<li class="toctree-l1"><a class="reference internal" href="dimensional_analysis.html">Working with units</a></li>
<li class="toctree-l1"><a class="reference internal" href="readwrite.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="amber.html">The Amber file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="charmm.html">The CHARMM file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gromacs.html">The GROMACS file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="rosetta.html">PyRosetta Integration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#command-syntax">Command syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#available-commands">Available commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add12-6-4">add12_6_4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#addatomicnumber">addAtomicNumber</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adddihedral">addDihedral</a></li>
<li class="toctree-l3"><a class="reference internal" href="#addexclusions">addExclusions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#addljtype">addLJType</a></li>
<li class="toctree-l3"><a class="reference internal" href="#addpdb">addPDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cd">cd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chamber">chamber</a></li>
<li class="toctree-l3"><a class="reference internal" href="#change">change</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changelj14pair">changeLJ14Pair</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changeljpair">changeLJPair</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changeljsingletype">changeLJSingleType</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changeprotstate">changeProtState</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changeradii">changeRadii</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changeredoxstate">changeRedoxState</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkvalidity">checkValidity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#definesolvent">defineSolvent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deletebond">deleteBond</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deletedihedral">deleteDihedral</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deletepdb">deletePDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#energy">energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gromber">gromber</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmassrepartition">HMassRepartition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpolate">interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listparms">listParms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmod">lmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loadcoordinates">loadCoordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loadrestrt">loadRestrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ls">ls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#minimize">minimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#netcharge">netCharge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openmm">OpenMM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outcif">outCIF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outparm">outparm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outpdb">outPDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parm">parm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parmout">parmout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printangles">printAngles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printbonds">printBonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printdetails">printDetails</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printdihedrals">printDihedrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printflags">printFlags</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printinfo">printInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printljmatrix">printLJMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printljtypes">printLJTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#printpointers">printPointers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scale">scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scee">scee</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scnb">scnb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setangle">setAngle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setbond">setBond</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setmolecules">setMolecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setoverwrite">setOverwrite</a></li>
<li class="toctree-l3"><a class="reference internal" href="#source">source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#strip">strip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timerge">tiMerge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writecoordinates">writeCoordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writefrcmod">writeFrcmod</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writeoff">writeOFF</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#atom-selection-masks">Atom Selection Masks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#residue-selections">Residue Selections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#atom-selections">Atom selections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wild-cards">Wild-cards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#residue-atom-selections">Residue-Atom Selections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distance-based-masks">Distance-based masks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#limited-embedded-python-interpreter">Limited Embedded Python Interpreter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-very-dirty-trick">A very dirty trick</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#using-xparmed">Using <code class="docutils literal notranslate"><span class="pre">xparmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="parmed_api.html">The ParmEd API</a></li>
<li class="toctree-l1"><a class="reference internal" href="openmm.html">OpenMM Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Functionality</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ParmEd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/parmed.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-parmed">
<h1>Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code><a class="headerlink" href="#using-parmed" title="Permalink to this headline">¶</a></h1>
<p>This page details using the command-line version of ParmEd, which is the
primary front-end program using the <a class="reference internal" href="api/parmed/parmed.html#module-parmed" title="parmed"><code class="xref py py-mod docutils literal notranslate"><span class="pre">parmed</span></code></a> and <a class="reference internal" href="api/parmed/parmed.tools.html#module-parmed.tools" title="parmed.tools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">parmed.tools</span></code></a>
packages to provide a set of <em>Actions</em> by which you can modify a system topology
and parameters (it currently only works for Amber topology files, although
support for the entire <a class="reference internal" href="structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a>
hierarchy is planned).</p>
<p>There are two ways in which ParmEd can be run—in batch reading from an input
file or <em>script</em>, and with an interactive interpreter. A script can either be
given to <code class="docutils literal notranslate"><span class="pre">parmed</span></code> on the command-line, or fed via pipes through standard
input. You can provide an input file using the <code class="docutils literal notranslate"><span class="pre">-i/--input</span></code> flag.</p>
<div class="section" id="command-syntax">
<h2>Command syntax<a class="headerlink" href="#command-syntax" title="Permalink to this headline">¶</a></h2>
<p>All actions should be specified on the <code class="docutils literal notranslate"><span class="pre">parmed</span></code> command-line in the
following format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ActionName arg1 arg2 arg3 ... argN [parm &lt;idx|name&gt;]
</pre></div>
</div>
<p>Arguments should be whitespace-delimited, the <code class="docutils literal notranslate"><span class="pre">ActionName</span></code> is
case-insensitive, and every action (if it uses a <code class="docutils literal notranslate"><span class="pre">parm</span></code> object) can be applied
to a specific parameter-topology instance that has been loaded.</p>
<p>Note that in many Actions, you need to select a subset of the atoms upon which
to perform the action. The way in which these atom selections are specified is
using the Amber mask syntax described in the section <a class="reference internal" href="#atom-selection-masks">Atom Selection Masks</a>
below.</p>
</div>
<div class="section" id="available-commands">
<h2>Available commands<a class="headerlink" href="#available-commands" title="Permalink to this headline">¶</a></h2>
<p>The following <code class="docutils literal notranslate"><span class="pre">Action</span></code> commands are available in ParmEd. The information here
is available via the <a href="#id1"><span class="problematic" id="id2">help_</span></a> command in the <code class="docutils literal notranslate"><span class="pre">parmed</span></code> interpreter.</p>
<div class="section" id="add12-6-4">
<h3>add12_6_4<a class="headerlink" href="#add12-6-4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>add12_6_4 [&lt;divalent ion mask&gt;] [c4file &lt;C4 Param. File&gt; | watermodel &lt;water model&gt;] [polfile &lt;Pol. Param File&gt; [tunfactor &lt;tunfactor&gt;]
</pre></div>
</div>
<dl class="simple">
<dt>Adds the LENNARD_JONES_CCOEF term for the new divalent metal ion 12-6-4 Lennard-Jones potential term. If provided, the mask will allow you to specify which ions are divalent. The C4 parameter between the metal ion and water can either be taken from Ref. <code class="docutils literal notranslate"><span class="pre">[1]</span></code> for the requested <code class="docutils literal notranslate"><span class="pre">[watermodel]</span></code> (TIP3P, TIP4PEW, or SPCE) or provided in the file specified by the c4file keyword. The polarizabilities must be present in the the polfile file. The chemical symbol of the element will be used to determine the atom type. Parameters are expected in a file with 2 columns:</dt><dd><p>&lt;atom type&gt; <code class="docutils literal notranslate"><span class="pre">&lt;parameter&gt;</span></code></p>
</dd>
</dl>
<p>All defaults come from Ref. <code class="docutils literal notranslate"><span class="pre">[1]</span></code> <code class="docutils literal notranslate"><span class="pre">[2]</span></code> and <code class="docutils literal notranslate"><span class="pre">[3]</span></code></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">[1]</span></code> Pengfei Li and Kenneth M. Merz, J. Chem. Theory Comput., 2014, 10,</dt><dd><p>289-297</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">[2]</span></code> Pengfei Li, Lin F. Song and Kenneth M. Merz, J. Phys. Chem. B, 2015,</dt><dd><p>119, 883-895</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">[3]</span></code> Pengfei Li, Lin F. Song and Kenneth M. Merz, J. Chem. Theory Comput.,</dt><dd><p>2015, 11, 1645-1657.</p>
</dd>
</dl>
</div>
<div class="section" id="addatomicnumber">
<h3>addAtomicNumber<a class="headerlink" href="#addatomicnumber" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>addAtomicNumber
</pre></div>
</div>
<p>Adds the atomic number of each atom to a new section titled “ATOMIC_NUMBER” in the topology file. Elements are identified by the atomic mass found in the MASS section of the topology files. Elements are matched by picking the element whose average atomic mass in the periodic table is closest to each atom, which should work appropriately for all isotopes of all atoms, except possibly Tritium</p>
</div>
<div class="section" id="adddihedral">
<h3>addDihedral<a class="headerlink" href="#adddihedral" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>addDihedral &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;mask4&gt; &lt;phi_k&gt; &lt;per&gt; &lt;phase&gt; [&lt;scee&gt;] [&lt;scnb&gt;] [type &lt;type&gt;]
</pre></div>
</div>
<p>Adds a dihedral between mask1, mask2, mask3, and mask4. Each mask must specify the same number of atoms, and the dihedral is defined around the bond between atoms in mask 2 and 3. If each mask selects 2 atoms, for instance, a dihedral will be placed around atom1 in mask 1, atom1 in mask 2, atom1 in mask 3, and atom1 in mask 4. A second dihedral will be placed around atom2 in mask 1, atom2 in mask 2, atom2 in mask 3, and atom2 in mask4.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> : Selection of one of the end-atoms for each dihedral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> : Selection of the middle atom bonded to <code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;mask3&gt;</span></code> in each dihedral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask3&gt;</span></code> : Selection of the other middle atom bonded to <code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;mask4&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask4&gt;</span></code> : Selection of the other end-atom in each dihedral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;phi_k&gt;</span></code> : Force constant in kcal/mol</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;per&gt;</span></code> : Periodicity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;phase&gt;</span></code> : Torsion phase shift</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;scnb&gt;</span></code> : 1-4 Lennard-Jones scaling constant (default 2.0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;scee&gt;</span></code> : 1-4 electrostatic scaling constant (default 1.2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span></code> : Type of dihedral, either “improper” or “normal”. Default is “normal”</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="addexclusions">
<h3>addExclusions<a class="headerlink" href="#addexclusions" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>addExclusions &lt;mask1&gt; &lt;mask2&gt;
</pre></div>
</div>
<p>Allows you to add arbitrary exclusions to the exclusion list. Every atom in <code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> is added to the exclusion list for each atom in <code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> so that non-bonded interactions between those atom pairs will not be computed. NOTE that this ONLY applies to direct-space (short-range) non-bonded potentials. For PME simulations, long-range electrostatics between these atom pairs are still computed (in different unit cells).</p>
</div>
<div class="section" id="addljtype">
<h3>addLJType<a class="headerlink" href="#addljtype" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>addLJType &lt;mask&gt; [radius &lt;new_radius&gt;] [epsilon &lt;new_epsilon&gt;] [radius_14 &lt;new_radius14&gt;] [epsilon_14 &lt;new_epsilon14&gt;]
</pre></div>
</div>
<p>Turns given mask into a new LJ atom type. It uses the radius and Rmin from the first atom type in <code class="docutils literal notranslate"><span class="pre">&lt;mask&gt;</span></code> if new_radius or new_epsilon aren’t provided</p>
</div>
<div class="section" id="addpdb">
<h3>addPDB<a class="headerlink" href="#addpdb" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>addPDB &lt;filename&gt; [elem] [strict] [allicodes]
</pre></div>
</div>
<p>Adds PDB information to new flags in an Amber topology file to enable analyses based on the original residue information in the PDB file, <code class="docutils literal notranslate"><span class="pre">&lt;filename&gt;</span></code> It adds the flags:</p>
<p>Residue Properties</p>
<blockquote>
<div><ul class="simple">
<li><p>RESIDUE_CHAINID: The chain ID of each residue (* if LEaP added it)</p></li>
<li><p>RESIDUE_ICODE: Insertion code, if it exists</p></li>
<li><p>RESIDUE_NUMBER: Original residue serial number in the PDB</p></li>
</ul>
</div></blockquote>
<p>Atom Properties</p>
<blockquote>
<div><ul class="simple">
<li><p>ATOM_ELEMENT: Atomic element (redundant now, not printed by default)</p></li>
<li><p>ATOM_OCCUPANCY: The occupancy of each atom</p></li>
<li><p>ATOM_BFACTOR: The temperature factor of each atom</p></li>
<li><p>ATOM_NUMBER: The original atom serial number in the PDB</p></li>
</ul>
</div></blockquote>
<p>The ‘strict’ keyword turns residue mismatches (NOT solvent) into errors The ‘elem’ keyword will force printing of the element names. The ‘allicodes’ keyword forces insertion codes to be printed, even if every one will be blank (so that parsers can count on that section existing).</p>
<p>Residues <em>not</em> in the PDB will be assigned a CHAINID of ‘*’ and RESIDUE_NUMBER of 0. Any occupancy or temperature (B) factor that is not present in the input PDB file is assigned a number of 0</p>
<dl class="simple">
<dt>Historical info:</dt><dd><p>This action is based on, and reproduces the key results of, the historical ‘add_pdb’ program. It is a bit more flexible, though.</p>
</dd>
</dl>
</div>
<div class="section" id="cd">
<h3>cd<a class="headerlink" href="#cd" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd &lt;directory&gt;
</pre></div>
</div>
<p>Changes to a new directory like UNIX ‘cd’</p>
</div>
<div class="section" id="chamber">
<h3>chamber<a class="headerlink" href="#chamber" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>chamber -top &lt;RTF&gt; -param &lt;PAR&gt; [-str &lt;STR&gt;] -psf &lt;PSF&gt; [-crd &lt;CRD&gt;] [-nocmap] [-box a,b,c[,alpha,beta,gamma]|bounding] [-radii &lt;radiusset&gt;] [nosettle]
</pre></div>
</div>
<p>This action will read CHARMM parameter, topology (RTF), and stream (STR) files and apply those parameters to a structure defined in a CHARMM PSF (protein structure file). XPLOR, CHARMM, and VMD-generated PSF files are all supported. You may specify -top, -param, and -str as many times as you want to provide multiple parameter files. All topology files are read first (in the order they are specified), followed by all parameter files, and finally all stream files are read in. Topology files are only necessary if the parameter files do not define the atom types (newer CHARMM force fields define atom types directly in the parameter file. Environment variables and shell wild-cards (* and ?), as well as the home shortcut character ~ are properly expanded when looking for files.</p>
<p>Options</p>
<blockquote>
<div><ul class="simple">
<li><p>-top CHARMM topology, or Residue Topology File (RTF) file</p></li>
<li><p>-param CHARMM parameter file</p></li>
<li><p>-str CHARMM stream file. Only RTF and parameter sections read</p></li>
<li><p>-toppar CHARMM topology, parameter, and/or stream file(s). File type is detected from extension (or in the case of .inp files, the presence of ‘top’, ‘par’ in the name)</p></li>
<li><p>-psf CHARMM PSF file</p></li>
<li><p>-crd Coordinate file (PDB, CHARMM CRD, Amber restart, etc.)</p></li>
<li><p>-nocmap Do not use any CMAP parameters</p></li>
<li><p>-box Box dimensions. If no angles are defined, they are assumed to be 90 degrees (orthorhombic box). Alternatively, you can use the word ‘bounding’ to define a box that encloses the centers of all atoms.</p></li>
<li><p>-radii Implicit solvent solvation radii. <code class="docutils literal notranslate"><span class="pre">&lt;radiusset&gt;</span></code> can be amber6, bondi, mbondi, mbondi2, mbondi3 Same effect as the <a class="reference internal" href="#changeradii">changeRadii</a> command. Default is mbondi.</p></li>
<li><p>nosettle This avoids changing the names of the water residue and oxygen atoms from TIP3 and OH2 to WAT and O</p></li>
</ul>
</div></blockquote>
<p>If the PDB file has a CRYST1 record, the box information will be set from there. Any box info given on the command-line will override the box found in the crd file.</p>
</div>
<div class="section" id="change">
<h3>change<a class="headerlink" href="#change" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>change &lt;property&gt; &lt;mask&gt; &lt;new_value&gt; [quiet]
</pre></div>
</div>
<p>Changes the property of given atoms to a new value. <code class="docutils literal notranslate"><span class="pre">&lt;property&gt;</span></code> can be CHARGE, MASS, RADII, SCREEN, ATOM_NAME, ATOM_TYPE, ATOM_TYPE_INDEX, or ATOMIC_NUMBER (note, changing elements with this command will NOT change their assignment for SHAKE!).</p>
<p>If given, the <code class="docutils literal notranslate"><span class="pre">[quiet]</span></code> keyword will prevent ParmEd from printing out a <a class="reference internal" href="#summary">summary</a> with every property changed for every atom that was changed useful for suppressing overwhelming output if you are zeroing every charge, for instance)</p>
</div>
<div class="section" id="changelj14pair">
<h3>changeLJ14Pair<a class="headerlink" href="#changelj14pair" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>changeLJ14Pair &lt;mask1&gt; &lt;mask2&gt; &lt;Rmin&gt; &lt;epsilon&gt;
</pre></div>
</div>
<p>Changes a particular 1-4 Lennard Jones pair based on a given (pre-combined) epsilon/Rmin. Only valid for CHAMBER prmtops</p>
</div>
<div class="section" id="changeljpair">
<h3>changeLJPair<a class="headerlink" href="#changeljpair" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>changeLJPair &lt;mask1&gt; &lt;mask2&gt; &lt;Rmin&gt; &lt;epsilon&gt;
</pre></div>
</div>
<p>Changes a particular Lennard Jones pair based on a given (pre-combined) epsilon/Rmin</p>
</div>
<div class="section" id="changeljsingletype">
<h3>changeLJSingleType<a class="headerlink" href="#changeljsingletype" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>changeLJSingleType &lt;mask&gt; &lt;radius&gt; &lt;depth&gt;
</pre></div>
</div>
<p>Allows you to change the radius/well depth of a single LJ type specified by <code class="docutils literal notranslate"><span class="pre">&lt;mask&gt;</span></code> Note, this may change more than the atoms selected in just the mask! To find out what else will be changed, look at the output of <a class="reference internal" href="#printljtypes">printLJTypes</a>.</p>
<p>Use <a class="reference internal" href="#addljtype">addLJType</a> to change the Lennard-Jones parameters on a set of specific atoms.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask&gt;</span></code> : The selection of atoms to change the LJ type for. All atoms selected must have the same LJ type</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;radius&gt;</span></code> : Rmin/2 (van der Waals radius of the new type)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;depth&gt;</span></code> : Well-depth (a.k.a., epsilon)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="changeprotstate">
<h3>changeProtState<a class="headerlink" href="#changeprotstate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>changeProtState &lt;mask&gt; &lt;state #&gt;
</pre></div>
</div>
<p>Changes the protonation state of a given titratable residue that can be treated via constant pH MD in Amber.</p>
</div>
<div class="section" id="changeradii">
<h3>changeRadii<a class="headerlink" href="#changeradii" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>changeRadii &lt;radii_set&gt;
</pre></div>
</div>
<dl class="simple">
<dt>Changes intrinsic GB radii to the specified set: Allowed values are</dt><dd><p>amber6, bondi, mbondi, mbondi2, mbondi3</p>
</dd>
</dl>
</div>
<div class="section" id="changeredoxstate">
<h3>changeRedoxState<a class="headerlink" href="#changeredoxstate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>changeRedoxState &lt;mask&gt; &lt;state #&gt;
</pre></div>
</div>
<p>Changes the reduction state of a given titratable residue that can be treated via constant redox potential MD in Amber.</p>
</div>
<div class="section" id="checkvalidity">
<h3>checkValidity<a class="headerlink" href="#checkvalidity" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>checkValidity
</pre></div>
</div>
<p>Basic checks for prmtop validity.</p>
</div>
<div class="section" id="definesolvent">
<h3>defineSolvent<a class="headerlink" href="#definesolvent" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>defineSolvent &lt;residue_list&gt;
</pre></div>
</div>
<p>Allows you to change what parmed will consider to be “solvent”. &lt;residue list&gt; must be a comma-separated set of residue names with no spaces between them.</p>
</div>
<div class="section" id="deletebond">
<h3>deleteBond<a class="headerlink" href="#deletebond" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>deleteBond &lt;mask1&gt; &lt;mask2&gt;
</pre></div>
</div>
<p>This action deletes any bonds that occur between the atoms in two masks.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> : Amber mask defining one of the atoms in a bond</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> : Amber mask defining the other atom in the bond</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[verbose]</span></code> : Print out every bond that is deleted as well as the number of other valence terms that were eliminated.</p></li>
</ul>
</div></blockquote>
<p>All bonds will be matched in which one atom comes from <code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> and the other atom comes from <code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> This action will also delete any other valence term (like angles and dihedrals) that would get severed by the deletion of one of the bonds.</p>
</div>
<div class="section" id="deletedihedral">
<h3>deleteDihedral<a class="headerlink" href="#deletedihedral" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>deleteDihedral &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;mask4&gt;
</pre></div>
</div>
<p>Deletes the dihedral around <code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;mask3&gt;</span></code> in which the end-groups are <code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;mask4&gt;</span></code> For multi-term dihedrals, it removes each term.</p>
</div>
<div class="section" id="deletepdb">
<h3>deletePDB<a class="headerlink" href="#deletepdb" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>deletePDB
</pre></div>
</div>
<p>This action deletes the flags added by <a class="reference internal" href="#addpdb">addPDB</a> if they are present.</p>
</div>
<div class="section" id="energy">
<h3>energy<a class="headerlink" href="#energy" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>energy [cutoff &lt;cut&gt;] [[igb &lt;IGB&gt;] [saltcon &lt;conc&gt;] | [Ewald]] [nodisper] [omm] [applayer] [platform &lt;platform&gt;] [precision &lt;precision model&gt;] [decompose]
</pre></div>
</div>
<p>This action will compute a single-point energy for the loaded structure (you must use ‘loadRestart’ prior to this command to load coordinates). The following options and keywords are supported:</p>
<p>Options</p>
<blockquote>
<div><ul class="simple">
<li><p>cutoff <code class="docutils literal notranslate"><span class="pre">&lt;cut&gt;</span></code> : The size of the non-bonded cutoff, in Angstroms. Default 8 A for periodic systems or infinite for nonperiodic systems</p></li>
</ul>
</div></blockquote>
<p>For systems with no periodic box information</p>
<blockquote>
<div><ul class="simple">
<li><p>igb <code class="docutils literal notranslate"><span class="pre">&lt;IGB&gt;</span></code> : An integer corresponding to the desired GB model. May be 1, 2, 5, 7, or 8 as described by the sander and pmemd manual. Default 5.</p></li>
<li><p>saltcon <code class="docutils literal notranslate"><span class="pre">&lt;conc&gt;</span></code> : The salt concentration, in mol/L, modeled by a Debye screening parameter. Default 0.0</p></li>
</ul>
</div></blockquote>
<p>For periodic systems</p>
<blockquote>
<div><ul class="simple">
<li><p>Ewald : Use an Ewald sum to compute long-range electrostatics instead of PME</p></li>
<li><p>nodisper : Do not use a long-range vdW dispersion correction</p></li>
</ul>
</div></blockquote>
<p>OpenMM-specific options</p>
<blockquote>
<div><ul class="simple">
<li><p>omm : If present, this keyword will instruct ParmEd to use <a class="reference internal" href="#openmm">OpenMM</a> to compute the energies (and optionally forces) using <a class="reference internal" href="#openmm">OpenMM</a> instead of sander.</p></li>
<li><p>platform <code class="docutils literal notranslate"><span class="pre">&lt;platform&gt;</span></code> : <a class="reference internal" href="#openmm">OpenMM</a> compute platform to use. Options are CUDA, OpenCL, Reference, and CPU. Consult the <a class="reference internal" href="#openmm">OpenMM</a> manual for details (only used if ‘omm’ is provided)</p></li>
<li><p>precision &lt;precision model&gt; : Precision model to use. Options are single, double, and mixed. Reference platform is always double and CPU platform is always single. Mixed (default) uses single precision for calculations and double for accumulation (only used if ‘omm’ is provided)</p></li>
<li><p>decompose : Print bond, angle, dihedral, and nonbonded energies separately</p></li>
<li><p>applayer : Use OpenMM’s class to compute the energy</p></li>
</ul>
</div></blockquote>
<p>Examples</p>
<blockquote>
<div><p># Using AMBER import parmed as pmd <a class="reference internal" href="#parm">parm</a> = pmd.load_file(‘prmtop’, xyz=’rst7’) pmd.tools.energy(parm, ‘igb 8’).execute()</p>
<p># Using Openmm pmd.tools.energy(parm, ‘igb 5 omm’).execute()</p>
</div></blockquote>
</div>
<div class="section" id="gromber">
<h3>gromber<a class="headerlink" href="#gromber" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gromber &lt;top_file&gt; [&lt;coord_file&gt;] [define &lt;DEFINE[=VAR]&gt;] [topdir &lt;directory&gt;] [radii &lt;radiusset&gt;]
</pre></div>
</div>
<p>Load a Gromacs topology file with parameters as an Amber-formatted system. Note, if your Gromacs topology file requires any include topology files, you will need to have Gromacs installed for this to work.</p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;top_file&gt;: The Gromacs topology file to load</p></li>
<li><p>&lt;coord_file&gt;: The coordinate file to load into the system. Can be any recognized format (GRO, PDB, mmCIF, inpcrd, etc.)</p></li>
<li><p>define &lt;DEFINE[=VAR]&gt;: Preprocessor defines that control the processing of the Gromacs topology file.</p></li>
<li><p>topdir &lt;directory&gt;: The directory containing all Gromacs include topology files. This is only necessary if Gromacs is not installed in a location that ParmEd can find.</p></li>
<li><p>radii &lt;radiusset&gt;: The GB radius set to use. Can be ‘mbondi’, ‘bondi’, ‘mbondi2’, or ‘amber6’. Default is mbondi</p></li>
</ul>
</div></blockquote>
<p>Gromacs topology files do not store the unit cell information. Therefore, in order to make sure that unit cell information is properly assigned to the resulting system, the provided <code class="docutils literal notranslate"><span class="pre">&lt;coord_file&gt;</span></code> should contain unit cell information (e.g., GRO, PDB, PDBx/mmCIF, and inpcrd files can all store box information).</p>
<p>ParmEd will try to locate the Gromacs topology directory using either the GMXDATA or GMXBIN environment variables (which should point to the <code class="docutils literal notranslate"><span class="pre">$PREFIX/share/gromacs</span></code> or <code class="docutils literal notranslate"><span class="pre">$PREFIX/bin</span></code> directories, respectively, where $PREFIX is the install prefix). If neither is set, the topology directory is located relative to the location of the <code class="docutils literal notranslate"><span class="pre">gmx</span></code> (Gromacs 5+) or <code class="docutils literal notranslate"><span class="pre">pdb2gmx</span></code> (Gromacs 4 or older) in the user’s PATH. If none of the above is true, the default installation location (/usr/local/gromacs/share/gromacs/top) is used. Any provided <code class="docutils literal notranslate"><span class="pre">topdir</span></code> will override default choices (but only for this particular command – future <code class="docutils literal notranslate"><span class="pre">gromber</span></code> actions will use the default location again).</p>
<p>You can provide as many defines as you wish, and the ordering you specify them is preserved. The default value assigned to each define is “1”. To provide multiple defines, use the <code class="docutils literal notranslate"><span class="pre">define</span></code> keyword multiple times, for example:</p>
<p>define MYVAR=something define MYVAR2=something_else …</p>
</div>
<div class="section" id="hmassrepartition">
<h3>HMassRepartition<a class="headerlink" href="#hmassrepartition" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>HMassRepartition [&lt;mass&gt;] [dowater]
</pre></div>
</div>
<p>This action implements hydrogen mass repartitioning in the system by changing the mass of each hydrogen to the desired value (the default new hydrogen mass is 3.024 daltons) and adjusting the mass of the atom to which it is bonded by the amount required to leave the total mass unchanged. By default, water hydrogen masses are unchanged (the SETTLE algorithm for implementing constraints on water molecules is analytical). Water masses can be repartitioned as well with the ‘dowater’ keyword.</p>
</div>
<div class="section" id="interpolate">
<h3>interpolate<a class="headerlink" href="#interpolate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>interpolate &lt;nparm&gt; [parm2 &lt;other_parm&gt;] [eleconly] [prefix &lt;prefix&gt;] [startnum &lt;num&gt;]
</pre></div>
</div>
<p>Interpolates between two topology files (VDW and electrostatic terms only). If <code class="docutils literal notranslate"><span class="pre">[eleconly]</span></code> is present, only the charges will be interpolated. <code class="docutils literal notranslate"><span class="pre">&lt;nparm&gt;</span></code> is the number of ‘interpolated’ topology files you want (in addition to the two end-points). The second prmtop must be specified if there are more than 2 parms currently loaded in the ParmEd <a class="reference internal" href="#parm">parm</a> list. startnum has no effect on the generated prmtops, but it can be used to control the names of the outputted topology files.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;nparm&gt;</span></code> : Number of topology files that will be generated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;other_parm&gt;</span></code> : The other <a class="reference internal" href="#parm">parm</a> object used in interpolation if more than 2 parms are present (first <a class="reference internal" href="#parm">parm</a> is active one)</p></li>
<li><p>eleconly : Only do charge interpolation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;prefix&gt;</span></code> : Generated <a class="reference internal" href="#parm">parm</a> objects will be written as &lt;prefix&gt;.#, where # starts from <code class="docutils literal notranslate"><span class="pre">&lt;num&gt;</span></code> and increases by 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;num&gt;</span></code> : Starting number for file names (see <code class="docutils literal notranslate"><span class="pre">&lt;prefix&gt;</span></code> above)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="listparms">
<h3>listParms<a class="headerlink" href="#listparms" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>listParms
</pre></div>
</div>
<p>Lists all of the loaded topology files</p>
</div>
<div class="section" id="lmod">
<h3>lmod<a class="headerlink" href="#lmod" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lmod
</pre></div>
</div>
<p>Adjusts Lennard Jones parameters to work with the LMOD code in Amber (changes LJ A coefficients that are 0 to 1000).</p>
</div>
<div class="section" id="loadcoordinates">
<h3>loadCoordinates<a class="headerlink" href="#loadcoordinates" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>loadCoordinates &lt;filename&gt;
</pre></div>
</div>
<p>Reads a coordinate file and loads the first set of coordinates found into the active structure. File type is auto-detected. Supported file formats include:</p>
<blockquote>
<div><ul class="simple">
<li><p>Amber restart file</p></li>
<li><p>Amber NetCDF restart file</p></li>
<li><p>CHARMM coordinate file</p></li>
<li><p>CHARMM restart file</p></li>
<li><p>Amber mdcrd trajectory</p></li>
<li><p>Amber NetCDF trajectory</p></li>
<li><p>PDB file</p></li>
<li><p>PDBx/mmCIF file</p></li>
<li><p>Gromacs GRO file</p></li>
<li><p>Mol2 file</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="loadrestrt">
<h3>loadRestrt<a class="headerlink" href="#loadrestrt" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>loadRestrt &lt;restrt_filename&gt;
</pre></div>
</div>
<p>Loads a restart file so we have coordinates. Necessary for distance-based mask criteria and <a class="reference internal" href="#writeoff">writeOFF</a></p>
</div>
<div class="section" id="ls">
<h3>ls<a class="headerlink" href="#ls" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ls [Unix ls options]
</pre></div>
</div>
<p>Lists directory contents. Like UNIX ‘ls’</p>
</div>
<div class="section" id="minimize">
<h3>minimize<a class="headerlink" href="#minimize" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>minimize [cutoff &lt;cut&gt;] [[igb &lt;IGB&gt;] [saltcon &lt;conc&gt;]] [[restrain &lt;mask&gt;] [weight &lt;k&gt;]] [norun] [script &lt;script_file.py&gt;] [platform &lt;platform&gt;] [precision &lt;precision model&gt;] [tol &lt;tolerance&gt;] [maxcyc &lt;cycles&gt;] [omm]
</pre></div>
</div>
<p>This action takes a structure and minimizes the <a class="reference internal" href="#energy">energy</a> using either scipy.optimize.minimize (with BFGS) and the sander API <em>or</em> <a class="reference internal" href="#openmm">OpenMM</a>. Following this action, the coordinates stored in the topology will be the minimized structure</p>
<p>General Options</p>
<blockquote>
<div><ul class="simple">
<li><p>omm Use <a class="reference internal" href="#openmm">OpenMM</a> instead of sander+scipy to minimize</p></li>
<li><p>cutoff <code class="docutils literal notranslate"><span class="pre">&lt;cutoff&gt;</span></code> Nonbonded cutoff in Angstroms</p></li>
<li><p>tol <code class="docutils literal notranslate"><span class="pre">&lt;tolerance&gt;</span></code> The largest <a class="reference internal" href="#energy">energy</a> difference between successive steps in the minimization allow the minimization to stop (Default 0.001)</p></li>
<li><p>maxcyc <code class="docutils literal notranslate"><span class="pre">&lt;cycles&gt;</span></code> The maximum number of minimization cycles permitted. No limit by default (minimization stops when tolerance is satisfied)</p></li>
</ul>
</div></blockquote>
<p>Implicit Solvent options</p>
<blockquote>
<div><ul class="simple">
<li><p>igb <code class="docutils literal notranslate"><span class="pre">&lt;IGB&gt;</span></code> GB model to use (0=No GB, 1,2,5,7,8 correspond to Amber models)</p></li>
<li><p>saltcon <code class="docutils literal notranslate"><span class="pre">&lt;conc&gt;</span></code> Salt concentration for GB in Molarity</p></li>
</ul>
</div></blockquote>
<p>OpenMM-specific options</p>
<blockquote>
<div><ul class="simple">
<li><p>restrain <code class="docutils literal notranslate"><span class="pre">&lt;mask&gt;</span></code> Selection of atoms to restrain</p></li>
<li><p>weight <code class="docutils literal notranslate"><span class="pre">&lt;k&gt;</span></code> Weight of positional restraints (kcal/mol/A^2)</p></li>
<li><p>norun Do not run the calculation</p></li>
<li><p>script <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> Name of the Python script to write to run this calculation</p></li>
<li><p>platform <code class="docutils literal notranslate"><span class="pre">&lt;platform&gt;</span></code> Which compute platform to use. Options are CUDA, OpenCL, CPU, and Reference. Consult <a class="reference internal" href="#openmm">OpenMM</a> docs for more information</p></li>
<li><p>precision <code class="docutils literal notranslate"><span class="pre">&lt;precision_model&gt;</span></code> Which precision model to use. Can be “single”, “double”, or “mixed”, and only has an effect on the CUDA and OpenCL platforms.</p></li>
</ul>
</div></blockquote>
<p>The implicit solvent options will be ignored for systems with periodic boundary conditions. The precision option will be ignored for platforms that do not support user-specified precision. The platform, precision, and script arguments will be ignored unless <code class="docutils literal notranslate"><span class="pre">omm</span></code> is specified.</p>
</div>
<div class="section" id="netcharge">
<h3>netCharge<a class="headerlink" href="#netcharge" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>netCharge [&lt;mask&gt;]
</pre></div>
</div>
<p>Prints the total charge of all of the atoms given by the mask. Defaults to all atoms</p>
</div>
<div class="section" id="openmm">
<h3>OpenMM<a class="headerlink" href="#openmm" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>OpenMM [-p &lt;parm&gt;|&lt;parm index&gt;] [sander/pmemd options] [-platform &lt;platform&gt;] [-precision &lt;precision model&gt;] [dcd] [progress] [script &lt;script_file.py&gt;] [norun]
</pre></div>
</div>
<p>This class will read a sander/pmemd input file and run an equivalent simulation using the OpenMM Python API. It uses a topology file that has been defined (and/or modified) here. The command-line flags are identical to those used for sander and pmemd (described in the Amber manual). You can additionally specify a computational platform available through OpenMM such as CUDA, OpenCL, Reference, and CPU.</p>
<p>The default prmtop will be the ‘active’ <a class="reference internal" href="#parm">parm</a>. The prmtop can be changed using either the ‘parm’ keyword or the ‘-p’ flag, but it must resolve to one of the stored topology files. Any <a class="reference internal" href="#parm">parm</a> given with the ‘-p’ flag has precedence. If present, the ‘dcd’ keyword triggers writting DCD-formatted trajectory files instead of NetCDF when ioutfm=1. The DCD trajectory writing offers binary trajectory support without requiring a NetCDF-Python library.</p>
<p>The ‘progress’ keyword triggers printing of ParmEd’s progress in setting up and starting the calculation.</p>
<p>The ‘script’ keyword provides a file to write an OpenMM script that performs the same calculation requested by this ParmEd command. The ‘norun’ command will prevent anything from actually being run and can only be used when a script file is provided.</p>
</div>
<div class="section" id="outcif">
<h3>outCIF<a class="headerlink" href="#outcif" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>outCIF &lt;file&gt; [norenumber] [charmm] [anisou]
</pre></div>
</div>
<p>Write a PDBx/mmCIF file from the currently active system to <code class="docutils literal notranslate"><span class="pre">&lt;file&gt;</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;file&gt;: The PDBx/mmCIF file to write</p></li>
<li><p>[norenumber]: Use the original atom and residue numbering if available</p></li>
<li><p>[anisou]: Write anisotropic B-factors if available</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="outparm">
<h3>outparm<a class="headerlink" href="#outparm" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>outparm &lt;prmtop_name&gt; [&lt;inpcrd_name&gt;] [netcdf]
</pre></div>
</div>
<p>Prints a new prmtop like <a class="reference internal" href="#parmout">parmout</a>, but keeps its place in the action stack so several can be written out in 1 parmed session</p>
</div>
<div class="section" id="outpdb">
<h3>outPDB<a class="headerlink" href="#outpdb" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>outPDB &lt;file&gt; [norenumber] [charmm] [anisou]
</pre></div>
</div>
<p>Write a PDB file from the currently active system to <code class="docutils literal notranslate"><span class="pre">&lt;file&gt;</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>&lt;file&gt;: The PDB file to write</p></li>
<li><p>[norenumber]: Use the original atom and residue numbering if available</p></li>
<li><p>[charmm]: Put the SEGID, if available, in columns 72 to 76</p></li>
<li><p>[anisou]: Write anisotropic B-factors if available</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="parm">
<h3>parm<a class="headerlink" href="#parm" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>parm &lt;filename&gt; [&lt;filename&gt; [&lt;filename&gt; ...]] || parm copy &lt;filename&gt;|&lt;index&gt; || parm select &lt;filename&gt;|&lt;index&gt;
</pre></div>
</div>
<p>Either adds a new parm to the list of available parms to edit in ParmEd, or it sets a new ‘active’ parm to edit by default with new commands</p>
</div>
<div class="section" id="parmout">
<h3>parmout<a class="headerlink" href="#parmout" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>parmout &lt;prmtop_name&gt; [&lt;inpcrd_name&gt;] [netcdf]
</pre></div>
</div>
<p>Final prmtop written after all actions are complete</p>
</div>
<div class="section" id="printangles">
<h3>printAngles<a class="headerlink" href="#printangles" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printAngles [&lt;mask&gt; [&lt;mask&gt; [&lt;mask&gt;] ] ]
</pre></div>
</div>
<p>Prints all of the angles (with their details) for the given atoms in the mask. If a second mask is given, only atoms whose central atom is in the second mask and another atom is in the first mask is printed. If a third mask is given, the central atom must be in the second mask and the other two atoms must appear in the first <em>and</em> third masks (in any order).</p>
<p>If coordinates and parameter types are present, the value of the angle (in degrees) and its <a class="reference internal" href="#energy">energy</a> (in kcal/mol) are reported for each printed angle.</p>
</div>
<div class="section" id="printbonds">
<h3>printBonds<a class="headerlink" href="#printbonds" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printBonds [&lt;mask&gt; [&lt;mask&gt;] ]
</pre></div>
</div>
<p>Prints all of the bonds (with their details) for the given atoms in the mask. If a second mask is given, only bonds in which one atom appears in <em>each</em> list will be printed. If coordinates and parameter types are present, also print the actual distance (in Angstroms) and <a class="reference internal" href="#energy">energy</a> (in kcal/mol) for each printed bond.</p>
</div>
<div class="section" id="printdetails">
<h3>printDetails<a class="headerlink" href="#printdetails" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printDetails &lt;mask&gt;
</pre></div>
</div>
<p>Returns information about all atoms in a given mask</p>
</div>
<div class="section" id="printdihedrals">
<h3>printDihedrals<a class="headerlink" href="#printdihedrals" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printDihedrals [&lt;mask&gt; [&lt;mask&gt; [&lt;mask&gt; [&lt;mask&gt;] ] ] ]
</pre></div>
</div>
<p>Prints all of the dihedrals (with their details) for the given atoms in the mask. If multiple masks are given, only dihedrals that have one atom in each mask are printed. Ordering is important here, so the first atom must be in the first mask, the second atom in the second, etc. The order can be precisely reversed, but no other ordering is recognized.</p>
<p>If coordinates and parameter types are present, the value of the torsion angle (in degrees) and the <a class="reference internal" href="#energy">energy</a> of each dihedral (in kcal/mol) are reported for each printed dihedral.</p>
</div>
<div class="section" id="printflags">
<h3>printFlags<a class="headerlink" href="#printflags" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printFlags
</pre></div>
</div>
<p>Prints all %FLAGs found in the topology file</p>
</div>
<div class="section" id="printinfo">
<h3>printInfo<a class="headerlink" href="#printinfo" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printInfo &lt;flag&gt;
</pre></div>
</div>
<p>Prints all prmtop data corresponding to the given %FLAG</p>
</div>
<div class="section" id="printljmatrix">
<h3>printLJMatrix<a class="headerlink" href="#printljmatrix" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printLJMatrix &lt;mask&gt;|&lt;index&gt;
</pre></div>
</div>
<p>This function prints out how every atom type interacts with the atom type(s) in <code class="docutils literal notranslate"><span class="pre">&lt;mask&gt;</span></code> The atom types are printed as all type names that have at least one atom with the Lennard Jones index given in square brackets at the end. Alternatively, you can request a particular atom type index</p>
</div>
<div class="section" id="printljtypes">
<h3>printLJTypes<a class="headerlink" href="#printljtypes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printLJTypes [&lt;mask&gt;|&lt;type idx&gt;]
</pre></div>
</div>
<p>Prints the Lennard Jones type index for the given atom mask or, if no value is given, the LJ type index for each atom.</p>
</div>
<div class="section" id="printpointers">
<h3>printPointers<a class="headerlink" href="#printpointers" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>printPointers
</pre></div>
</div>
<p>Prints a list of all the POINTERS and their values</p>
</div>
<div class="section" id="scale">
<h3>scale<a class="headerlink" href="#scale" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scale &lt;FLAG&gt; &lt;factor&gt;
</pre></div>
</div>
<p>Multiplies all values in a particular section of an Amber prmtop by a scalar factor</p>
</div>
<div class="section" id="scee">
<h3>scee<a class="headerlink" href="#scee" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scee &lt;scee_value&gt;
</pre></div>
</div>
<p>Sets the 1-4 EEL scaling factor in the prmtop</p>
</div>
<div class="section" id="scnb">
<h3>scnb<a class="headerlink" href="#scnb" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>scnb &lt;scnb_value&gt;
</pre></div>
</div>
<p>Sets the 1-4 VDW scaling factor in the prmtop</p>
</div>
<div class="section" id="setangle">
<h3>setAngle<a class="headerlink" href="#setangle" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setAngle &lt;mask1&gt; &lt;mask2&gt; &lt;mask3&gt; &lt;k&gt; &lt;THETeq&gt;
</pre></div>
</div>
<p>Changes (or adds a non-existent) angle in the topology file. Each mask must select the same number of atoms, and an angle will be placed between the atoms in mask1, mask2, and mask3 (one angle between atom1 from mask1, atom1 from mask2, and atom1 from mask3, another angle between atom2 from mask1, atom2 from mask2, and atom2 from mask3, etc.)</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> : The selection of one of the end-atoms in each angle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> : The selection of central atoms in each angle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask3&gt;</span></code> : The selection of other end-atoms in each angle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;k&gt;</span></code> : Force constant in kcal/mol/radians^2 in <a class="reference internal" href="#energy">energy</a> expression k(THET - THETeq)^2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;THETeq&gt;</span></code> : Equilibrium angle (in <em>degrees</em>)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="setbond">
<h3>setBond<a class="headerlink" href="#setbond" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setBond &lt;mask1&gt; &lt;mask2&gt; &lt;k&gt; &lt;Req&gt;
</pre></div>
</div>
<p>Changes (or adds a non-existent) bond in the topology file. Each mask must select the same number of atoms, and a bond will be placed between the atoms in mask1 and mask2 (one bond between atom1 from mask1 and atom1 from mask2 and another bond between atom2 from mask1 and atom2 from mask2, etc.)</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask1&gt;</span></code> : Selection of first atoms in each bond</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;mask2&gt;</span></code> : Selection of second atoms in each bond</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;k&gt;</span></code> : Force constant (kcal/mol/A^2) in <a class="reference internal" href="#energy">energy</a> expression k(R-Req)^2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;Req&gt;</span></code> : Equilibrium distance (A)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="setmolecules">
<h3>setMolecules<a class="headerlink" href="#setmolecules" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setMolecules [solute_ions True|False]
</pre></div>
</div>
<p>Determines the molecularity of the system based on the bonding network and correctly determines the SOLVENT_POINTERS and ATOMS_PER_MOLECULE sections of the topology file. It will consider the ions to be part of the solute if True is passed or not if False is passed. Defaults to True.</p>
</div>
<div class="section" id="setoverwrite">
<h3>setOverwrite<a class="headerlink" href="#setoverwrite" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setOverwrite [True|False]
</pre></div>
</div>
<p>Necessary to overwrite original topology file name.</p>
</div>
<div class="section" id="source">
<h3>source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>source &lt;file&gt;
</pre></div>
</div>
<p>Sources a file with a list of parmed commands</p>
</div>
<div class="section" id="strip">
<h3>strip<a class="headerlink" href="#strip" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>strip &lt;mask&gt; [nobox]
</pre></div>
</div>
<p>Deletes the atoms specified by <code class="docutils literal notranslate"><span class="pre">&lt;mask&gt;</span></code> from the topology file and rebuilds the topology file according to the parameters that remain. If nobox is provided, the unit cell information is discarded (useful when stripping solvent to run an aperiodic implicit solvent calculation).</p>
</div>
<div class="section" id="summary">
<h3>summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>summary
</pre></div>
</div>
<p>Prints out a summary of prmtop contents</p>
</div>
<div class="section" id="timerge">
<h3>tiMerge<a class="headerlink" href="#timerge" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tiMerge &lt;mol1mask&gt; &lt;mol2mask&gt; &lt;scmask1&gt; &lt;scmask2&gt; [&lt;scmask1N&gt;] [&lt;scmask2N&gt;] [tol &lt;tol&gt;]
</pre></div>
</div>
<p>Merges molecules removing redundant bonding terms. Input amber masks corresponding to molecules 1/2 <code class="docutils literal notranslate"><span class="pre">&lt;mol1mask&gt;/&lt;mol2mask&gt;</span></code> and the soft core atoms in each molecule as <code class="docutils literal notranslate"><span class="pre">&lt;scmask1&gt;/&lt;scmask2&gt;</span></code> The input topology can be created using leap, with the two molecules to be merged adjacent to each other in residue number. This improves the efficiency for pmemd TI when only part of a molecule is being perturbed.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;scmask1/2N&gt;</span></code> are for softcore molecules that are not going to be merged. These options will just add these atoms to the timask output, correcting for any changes in atom number.</p>
<p>This can also be used for non-softcore simulations, where <code class="docutils literal notranslate"><span class="pre">&lt;scmask1&gt;/&lt;scmask2&gt;</span></code> represent the perturbed atoms. The output will give the scmask1/scmask2 flags, which can just be ignored.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;tol&gt;</span></code> is the tolerence to use when matching coordinates (default 0.01). This is used when the atoms in molecules 1/2 are not in the same order and for checking the input coordinates.</p>
</div>
<div class="section" id="writecoordinates">
<h3>writeCoordinates<a class="headerlink" href="#writecoordinates" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>writeCoordinates &lt;filename&gt; [netcdftraj | netcdf | pdb | cif | restart | mdcrd | mol2]
</pre></div>
</div>
<p>Writes the coordinates of the active structure to a coordinate file. The format of the file is detected from filename extension, with the following extensions being recognized:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.nc</span></code>: Amber NetCDF trajectory with a single frame</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.ncrst</span></code>: Amber NetCDF restart file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pdb</span></code>: PDB file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.cif</span></code>: PDBx/mmCIF file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.rst7</span></code>, <code class="docutils literal notranslate"><span class="pre">.restrt</span></code>, <code class="docutils literal notranslate"><span class="pre">.inpcrd</span></code>: Amber restart file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.mdcrd</span></code>: Amber mdcrd file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.mol2</span></code>: Sybyl Mol2 file</p></li>
<li><p>Default is Amber restart file</p></li>
</ul>
</div></blockquote>
<p>Alternatively, the following keywords can be used to override the filename extension:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">netcdftraj</span></code>: Amber NetCDF trajectory with a single frame</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netcdf</span></code>: Amber NetCDF restart file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdb</span></code>: PDB file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cif</span></code>: PDBx/mmCIF file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">restart</span></code>: Amber restart/inpcrd file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mdcrd</span></code>: Amber mdcrd file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mol2</span></code>: Sybyl mol2 file</p></li>
</ul>
</div></blockquote>
<p>Note, NetCDF files require scipy or netCDF4 to be installed.</p>
</div>
<div class="section" id="writefrcmod">
<h3>writeFrcmod<a class="headerlink" href="#writefrcmod" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>writeFrcmod &lt;frcmod_name&gt;
</pre></div>
</div>
<p>Writes an frcmod file from all of the parameters in the topology file.</p>
</div>
<div class="section" id="writeoff">
<h3>writeOFF<a class="headerlink" href="#writeoff" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>writeOFF &lt;OFF_filename&gt;
</pre></div>
</div>
<p>Writes an Amber OFF Library with all of the residues found in the topology</p>
</div>
</div>
<div class="section" id="atom-selection-masks">
<h2>Atom Selection Masks<a class="headerlink" href="#atom-selection-masks" title="Permalink to this headline">¶</a></h2>
<p>Atoms within a system are selected according to the Amber mask specification.
The selection syntax is described in detail in the Amber user’s manual, with
numerous examples in the <em>cpptraj</em> and <em>ambmask</em> sections.  I will include a
brief primer here for reference.</p>
<div class="section" id="residue-selections">
<h3>Residue Selections<a class="headerlink" href="#residue-selections" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">:</span></code> character is used to select specific residues by name and/or number.
The residues you wish to select may be a comma-separated list of numbers, number
ranges, names, or a mixed list of both.  Note that the residue number selections
apply to a numbering scheme in which the first residue is residue 1 and the
numbers increment sequentially from there (<em>i.e.</em>, any original numbering in
the starting file is ignored in standard mask selections). Examples are shown
below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>:1-5,10,ALA,TYR
:101
:ASP,GLU,HIS,LYS,TYR
</pre></div>
</div>
<p>The first example selects all atoms in residues 1 through 5, residue 10, and any
residues with the names “ALA” or “TYR” in the system. The second example selects
<em>only</em> residue number 101. The final mask selects all residues with names ASP,
GLU, HIS, LYS, or TYR.</p>
</div>
<div class="section" id="atom-selections">
<h3>Atom selections<a class="headerlink" href="#atom-selections" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> character is used to select specific atoms by name and/or number. The
atoms you wish to select may be a comma-separated list of numbers, number
ranges, names, or a mixed list of both. Like the residue selection above, atoms
are numbered sequentially starting from 1. Examples are shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@1-5,10,CA,CB
@101
@CA,CB,HA1,HA2,HA3
</pre></div>
</div>
<p>The first example selects the first five atoms, the 10th atom, and all atoms
with the names “CA” or “CB”. The second mask selects only the 101st atom. The
final mask selects all atoms with names CA, CB, HA1, HA2, or HA3.</p>
<p>Many atoms also have <em>type</em> names associated with them, that are often used to
distinguish chemical environments. These are really just force field
implementation details, as types often change between generations of force
fields to allow for increased parameter fitting flexibility. However, the two
characters <code class="docutils literal notranslate"><span class="pre">&#64;%</span></code> allow you to select atoms based on <em>type name</em> instead of
name (note, integer indices have no meaning for atom <em>type names</em>, so every type
in the list following <code class="docutils literal notranslate"><span class="pre">&#64;%</span></code> is interpreted as a string-like name).  Examples
include:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>@%CT,CX
@%N,H
</pre></div>
</div>
<p>The first example selects all atom <em>types</em> with the label “CT” or “CX”, while
the second chooses the atom types “N” or “H”.</p>
</div>
<div class="section" id="wild-cards">
<h3>Wild-cards<a class="headerlink" href="#wild-cards" title="Permalink to this headline">¶</a></h3>
<p>You can also use so-called <em>wild-cards</em> when selecting atoms. For instance,
suppose you want to select all hydrogen atoms, which you know all start with the
letter ‘H’, or all carbons which you know start with ‘C’. The following masks
will do these two tasks:</p>
<p>The “=” character works as a wild-card, as does the ‘*’ (so the above examples
could have been written with a ‘*’ instead). If either ‘=’ or ‘*’ is part of the
atom name, you can use the “&quot; character to escape it and have the mask parser
interpret it as a character literal.</p>
</div>
<div class="section" id="residue-atom-selections">
<h3>Residue-Atom Selections<a class="headerlink" href="#residue-atom-selections" title="Permalink to this headline">¶</a></h3>
<p>A frequent requirement is to select all atoms of a particular <em>name</em> from a
given residue (or set of residues). This can be done with the <code class="docutils literal notranslate"><span class="pre">|</span></code> binary
operator (see below), but it is so common that there is a shortcut for doing
this, shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>:ALA@CA,CB
:ASP@OD=
</pre></div>
</div>
<p>The first mask selects all CA and CB atoms from all ALA residues. The second
selects all atoms whose names start with the two letters OD (such as OD1 and
OD2) from all ASP residues.</p>
</div>
<div class="section" id="distance-based-masks">
<h3>Distance-based masks<a class="headerlink" href="#distance-based-masks" title="Permalink to this headline">¶</a></h3>
<p>Still other times you want to select all atoms (or all residues) within a
particular <em>distance</em> around a particular subset of atoms. This syntax can be
confusing, so I will try to walk through it carefully.</p>
</div>
</div>
<div class="section" id="limited-embedded-python-interpreter">
<h2>Limited Embedded Python Interpreter<a class="headerlink" href="#limited-embedded-python-interpreter" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">parmed</span></code> also comes equipped with a fully-fledged Python interpreter under
the hood.  You can run individual Python commands by starting the command with a
bang (<code class="docutils literal notranslate"><span class="pre">!</span></code>).  A double-bang (<code class="docutils literal notranslate"><span class="pre">!!</span></code>) indicates to <code class="docutils literal notranslate"><span class="pre">parmed</span></code> that a
multi-line Python code segment follows, and to interpret everything that comes
afterwards as Python code until another double-bang line (<code class="docutils literal notranslate"><span class="pre">!!</span></code>) appears. If
you are typing at the prompt inside the interpreter, the prompt changes to
<code class="docutils literal notranslate"><span class="pre">py</span> <span class="pre">&gt;&gt;&gt;</span></code> to indicate you are in the Python interpreter.</p>
<p>Note that running Python code can be insecure if the source of that code is
untrusted.  As a result, <code class="docutils literal notranslate"><span class="pre">parmed</span></code> will refuse to execute raw Python code
unless you explicitly give the interpreter permission to do so with the <code class="docutils literal notranslate"><span class="pre">-e</span></code>
command-line flag.</p>
<p>A simple example is shown below (input follows the prompts <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">py</span>
<span class="pre">&gt;&gt;&gt;</span></code>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ parmed -e

                                  /^^^/           /]
                                 /   ]           / ]
                         _______/    ]___       /  ]
                        /                \_____/   /
                      _/   [@]  \ \                \
                     /..         | |                ]
                      VVVvvv\    | |         _/\    ]
          P A R M E D       |               /    \  ]
                     AAA^^^^^              /       \]
                      \_________\   \_____/
                                \    \
                                 \____\

ParmEd: a Parameter file Editor


Reading input from STDIN...
&gt; !!
py &gt;&gt;&gt; def print_hello_world():
py &gt;&gt;&gt;     print &quot;Hello World&quot;
py &gt;&gt;&gt;
py &gt;&gt;&gt; print_hello_world()
py &gt;&gt;&gt; !!
Hello World
&gt; !print &quot;7 + 4 = %d&quot; % (7 + 4)
7 + 4 = 11
</pre></div>
</div>
<p>Notice that immediately after the closing <code class="docutils literal notranslate"><span class="pre">!!</span></code> in the first Python code block,
the Python code is executed. The interpreter takes the entire code typed between
the <code class="docutils literal notranslate"><span class="pre">!!</span></code> lines and interprets it as one string, preserving indentation, then
executes it.  On the other hand, a single <code class="docutils literal notranslate"><span class="pre">!</span></code> immediately runs that one line
of Python.</p>
<p>One “gotcha” here is that Python objects that you create in this interpreter are
not persistent—that is, the function <code class="docutils literal notranslate"><span class="pre">print_hello_world</span></code> no longer exists
after that code block closes, so you can’t use it in a later Python code block:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; !print_hello_world()
NameError: name &#39;print_hello_world&#39; is not defined
</pre></div>
</div>
<p>So the lesson here is that you either need to be able to encapsulate all Python
activity in a single code block, use the ParmEd API directly in your own Python
script, or make use of <a class="reference internal" href="#a-very-dirty-trick">A very dirty trick</a> that should make any Pythonista
wince.</p>
<p>Perhaps of the most importance, however, is that the topology file list is made
available to you in the Python interpreter namespace as the name
<code class="docutils literal notranslate"><span class="pre">amber_prmtop</span></code>, which is an instance of <a class="reference internal" href="api/parmed/parmed.tools.parmlist.html#parmed.tools.parmlist.ParmList" title="parmed.tools.parmlist.ParmList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParmList</span></code></a>. So <code class="docutils literal notranslate"><span class="pre">amber_prmtop.parm</span></code> is the currently
active parameter-topology object.</p>
<p>Let’s have a look at how we might be able to use that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; !print amber_prmtop.parm.bonds[0].type
&lt;BondType; k=570.000, Req=1.229&gt;
&gt; !!
py &gt;&gt;&gt; amber_prmtop.parm.bonds[0].type.k = 500.0
py &gt;&gt;&gt; print amber_prmtop.parm.bonds[0].type
py &gt;&gt;&gt; print amber_prmtop.parm.bonds[0]
py &gt;&gt;&gt; !!
&lt;BondType; k=500.000, Req=1.229&gt;
&lt;Bond &lt;Atom C [11]; In SER 0&gt;--&lt;Atom O [12]; In SER 0&gt;; type=&lt;BondType; k=500.000, Req=1.229&gt;&gt;
&gt; printBonds @12 @13
Atom 1               Atom 2               R eq       Frc Cnst
     12    C (   C)      13    O (   O)     1.2290   500.0000
</pre></div>
</div>
<p>Notice here how we changed our active prmtop by changing the bond force constant
of the first bond in the system (between atoms 12 and 13 when indexing from 1)
from 570 kcal/mol to 500 kcal/mol!</p>
<div class="section" id="a-very-dirty-trick">
<h3>A very dirty trick<a class="headerlink" href="#a-very-dirty-trick" title="Permalink to this headline">¶</a></h3>
<p>There is a small trick you can play to get objects you create to persist. I only
include this section because I find it entertaining and a possibly helpful
pedagogical diversion. I would <em>highly</em> recommend that you use the ParmEd API in
your own script before resorting to anything shown in this section.</p>
<p>The three objects available to you are <code class="docutils literal notranslate"><span class="pre">amber_prmtop</span></code>, <code class="docutils literal notranslate"><span class="pre">line</span></code>, and <code class="docutils literal notranslate"><span class="pre">self</span></code>.
The <code class="docutils literal notranslate"><span class="pre">line</span></code> object is the currently parsed input line (not very useful), and
<code class="docutils literal notranslate"><span class="pre">self</span></code> is the instance of the Python interpreter that is collecting your
input (and will be destroyed after the interpreter is finished).</p>
<p>So the only object that will persist past the destruction of the temporary
Python interpreter is <code class="docutils literal notranslate"><span class="pre">amber_prmtop</span></code> (and <code class="docutils literal notranslate"><span class="pre">type(self)</span></code>, but only in Python
3, since it is an old-style class in Python 2 by virtue of deriving from
<code class="docutils literal notranslate"><span class="pre">cmd.Cmd</span></code>).</p>
<p>So you can attach your function to the <a class="reference internal" href="api/parmed/parmed.tools.parmlist.html#parmed.tools.parmlist.ParmList" title="parmed.tools.parmlist.ParmList"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParmList</span></code></a> object <code class="docutils literal notranslate"><span class="pre">amber_prmtop</span></code> and retrieve it from
there later.  Be careful not to clobber a critical attribute of that class,
though!  This trick is demonstrated continuing from the interpreter session from
above:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; !!
py &gt;&gt;&gt; def print_hello_world():
py &gt;&gt;&gt;     print &quot;Hello world!&quot;
py &gt;&gt;&gt;
py &gt;&gt;&gt; amber_prmtop.custom_func = print_hello_world
py &gt;&gt;&gt; !!
&gt; !amber_prmtop.custom_func()
Hello world!
</pre></div>
</div>
<p>Notice that by keeping a reference to our function in the <code class="docutils literal notranslate"><span class="pre">amber_prmtop</span></code>
namespace, we could refer back to it later.</p>
<p>The clever Pythonista could figure out how to use other introspective commands
to gain control of other mechanisms as well—for instance, I used to disallow
import by blocking <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">foo</span></code> or <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">foo</span> <span class="pre">import</span> <span class="pre">bar</span></code>, but quickly found
that this alternative also worked:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; !!
py &gt;&gt;&gt; sys = __builtins__[&#39;__import__&#39;](&#39;sys&#39;)
py &gt;&gt;&gt; print repr(sys.version_info)
py &gt;&gt;&gt; !!
sys.version_info(major=2, minor=7, micro=9, releaselevel=&#39;final&#39;, serial=0)
</pre></div>
</div>
<p>So it seemed rather fruitless to prohibit behavior that was so easy to work
around!</p>
</div>
</div>
</div>
<div class="section" id="using-xparmed">
<h1>Using <code class="docutils literal notranslate"><span class="pre">xparmed</span></code><a class="headerlink" href="#using-xparmed" title="Permalink to this headline">¶</a></h1>
<p>An alternative to running the command-line-based <code class="docutils literal notranslate"><span class="pre">parmed</span></code> program is to use
the <em>Tkinter</em>-based GUI front-end, <code class="docutils literal notranslate"><span class="pre">xparmed</span></code>.  Note that not all actions
have been implemented in <code class="docutils literal notranslate"><span class="pre">xparmed</span></code>—if the one you need gives a message to
this effect, you will need to use <code class="docutils literal notranslate"><span class="pre">parmed</span></code> instead.</p>
<p><code class="docutils literal notranslate"><span class="pre">xparmed</span></code> is significantly more limited.  It cannot be scripted, and it
cannot process multiple topology files in the same session.  It may, however,
help you learn ParmEd better as well as lessen the learning curve for performing
basic tasks.</p>
<p>You can find more extensive documentation <a class="reference external" href="http://jswails.wikidot.com/parmed#toc3">by clicking here to go to my wiki</a>.</p>
<p>You can right-click on any of the buttons to get the same help printed above on
that action.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parmed_api.html" class="btn btn-neutral float-right" title="The API for ParmEd Command-line Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="omm_rosetta.html" class="btn btn-neutral float-left" title="Seeding OpenMM Simulations with PyRosetta and ParmEd" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Jason Swails

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>