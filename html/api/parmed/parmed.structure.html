

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>parmed.structure module &mdash; ParmEd  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> ParmEd
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.3319.g7a6168d
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../topologyobjects.html">Core classes used to represent topologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structure.html">The core Structure class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dimensional_analysis.html">Working with units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readwrite.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../amber.html">The Amber file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../charmm.html">The CHARMM file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gromacs.html">The GROMACS file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rosetta.html">PyRosetta Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed.html">Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed.html#using-xparmed">Using <code class="docutils literal notranslate"><span class="pre">xparmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed_api.html">The ParmEd API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openmm.html">OpenMM Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization.html">Visualization Functionality</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ParmEd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>parmed.structure module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/parmed/parmed.structure.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-parmed.structure">
<span id="parmed-structure-module"></span><h1>parmed.structure module<a class="headerlink" href="#module-parmed.structure" title="Permalink to this headline">¶</a></h1>
<p>This module contains the core base class for all of the chemical structures with
various topological and force field features.</p>
<dl class="py class">
<dt id="parmed.structure.Structure">
<em class="property">class </em><code class="sig-prename descclassname">parmed.structure.</code><code class="sig-name descname">Structure</code><a class="reference internal" href="../../_modules/parmed/structure.html#Structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A chemical structure composed of atoms, bonds, angles, torsions, and other
topological features</p>
<p class="rubric">Notes</p>
<p>This class also has a handful of type lists for each of the attributes above
(excluding <cite>atoms</cite>, <cite>residues</cite>, <cite>chiral_frames</cite>, and <cite>multipole_frames</cite>).
They are all TrackedList instances that are designed to hold the relevant
parameter type. The list is:</p>
<blockquote>
<div><p>bond_types, angle_types, dihedral_types, urey_bradley_types,
improper_types, cmap_types, trigonal_angle_types,
out_of_plane_bend_types, pi_torsion_types, stretch_bend_types,
torsion_torsion_types, adjust_types</p>
</div></blockquote>
<p>dihedral_types _may_ be a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">DihedralType</span></code> instances, since
torsion profiles are often represented by a Fourier series with multiple
terms</p>
<dl class="field-list">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl>
<dt><strong>atoms</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomList</span></code></span></dt><dd><p>List of all atoms in the structure</p>
</dd>
<dt><strong>residues</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueList</span></code></span></dt><dd><p>List of all residues in the structure</p>
</dd>
<dt><strong>bonds</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code>)</span></dt><dd><p>List of all bonds in the structure</p>
</dd>
<dt><strong>angles</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Angle</span></code>)</span></dt><dd><p>List of all angles in the structure</p>
</dd>
<dt><strong>dihedrals</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code>)</span></dt><dd><p>List of all dihedrals in the structure</p>
</dd>
<dt><strong>rb_torsions</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code>)</span></dt><dd><p>List of all Ryckaert-Bellemans torsions in the structure</p>
</dd>
<dt><strong>urey_bradleys</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UreyBradley</span></code>)</span></dt><dd><p>List of all Urey-Bradley angle bends in the structure</p>
</dd>
<dt><strong>impropers</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Improper</span></code>)</span></dt><dd><p>List of all CHARMM-style improper torsions in the structure</p>
</dd>
<dt><strong>cmaps</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Cmap</span></code>)</span></dt><dd><p>List of all CMAP objects in the structure</p>
</dd>
<dt><strong>trigonal_angles</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TrigonalAngle</span></code>)</span></dt><dd><p>List of all AMOEBA-style trigonal angles in the structure</p>
</dd>
<dt><strong>out_of_plane_bends</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">OutOfPlaneBends</span></code>)</span></dt><dd><p>List of all AMOEBA-style out-of-plane bending angles</p>
</dd>
<dt><strong>pi_torsions</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PiTorsion</span></code>)</span></dt><dd><p>List of all AMOEBA-style pi-torsion angles</p>
</dd>
<dt><strong>stretch_bends</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">StretchBend</span></code>)</span></dt><dd><p>List of all AMOEBA-style stretch-bend compound bond/angle terms</p>
</dd>
<dt><strong>torsion_torsions</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TorsionTorsion</span></code>)</span></dt><dd><p>List of all AMOEBA-style coupled torsion-torsion terms</p>
</dd>
<dt><strong>chiral_frames</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ChiralFrame</span></code>)</span></dt><dd><p>List of all AMOEBA-style chiral frames defined in the structure</p>
</dd>
<dt><strong>multipole_frames</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MultipoleFrame</span></code>)</span></dt><dd><p>List of all AMOEBA-style multipole frames defined in the structure</p>
</dd>
<dt><strong>adjusts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NonbondedException</span></code>)</span></dt><dd><p>List of all nonbonded pair-exception rules</p>
</dd>
<dt><strong>acceptors</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AcceptorDonor</span></code>)</span></dt><dd><p>List of all H-bond acceptors, if that information is present</p>
</dd>
<dt><strong>donors</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AcceptorDonor</span></code>)</span></dt><dd><p>List of all H-bond donors, if that information is present</p>
</dd>
<dt><strong>groups</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code>)</span></dt><dd><p>List of all CHARMM-style GROUP objects (whatever those are used for)</p>
</dd>
<dt><strong>box</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">6</span> <span class="pre">floats</span></code></span></dt><dd><p>Box dimensions (a, b, c, alpha, beta, gamma) for the unit cell. If no
box is defined, <cite>box</cite> is set to <cite>None</cite></p>
</dd>
<dt><strong>space_group</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>The space group of the structure (default is “P 1”)</p>
</dd>
<dt><strong>nrexcl</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>The number of bonds away that an atom can be in order to be excluded
from the direct nonbonded summation</p>
</dd>
<dt><strong>title</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Cosmetic only, it is an arbitrary title assigned to the system. Default
value is an empty string</p>
</dd>
<dt><a class="reference internal" href="#parmed.structure.Structure.positions" title="parmed.structure.Structure.positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">positions</span></code></a><span class="classifier">u.Quantity(list(Vec3), u.angstroms)</span></dt><dd><p>A list of 3-element Quantity tuples of dimension length representing the atomic positions for every atom in the system.</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier">np.ndarray of shape (nframes, natom, 3)</span></dt><dd><p>If no coordinates are set, this is set to None. The first frame will
match the coordinates present on the atoms.</p>
</dd>
<dt><strong>symmetry</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symmetry</span></code></span></dt><dd><p>if no symmetry is set, this is set to None.</p>
</dd>
<dt><strong>links</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Link</span></code>)</span></dt><dd><p>The list of Link definitions for this Structure</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.add_atom" title="parmed.structure.Structure.add_atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atom</span></code></a>(atom, resname, resnum[, chain, …])</p></td>
<td><p>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if it has a different name or number as the last residue added and adding it to the <cite>atoms</cite> list.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.add_atom_to_residue" title="parmed.structure.Structure.add_atom_to_residue"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atom_to_residue</span></code></a>(atom, residue)</p></td>
<td><p>Adds a new atom to the Structure at the end if the given residue</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.assign_bonds" title="parmed.structure.Structure.assign_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_bonds</span></code></a>(*reslibs)</p></td>
<td><p>Assigns bonds to all atoms based on the provided residue template libraries.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.copy" title="parmed.structure.Structure.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>(cls[, split_dihedrals])</p></td>
<td><p>Makes a copy of the current structure as an instance of a specified subclass</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.createSystem" title="parmed.structure.Structure.createSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">createSystem</span></code></a>([nonbondedMethod, …])</p></td>
<td><p>Construct an OpenMM System representing the topology described by the prmtop file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.get_box" title="parmed.structure.Structure.get_box"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_box</span></code></a>([frame])</p></td>
<td><p>In some cases, multiple conformations may be stored in the Structure.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.get_coordinates" title="parmed.structure.Structure.get_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coordinates</span></code></a>([frame])</p></td>
<td><p>In some cases, multiple conformations may be stored in the Structure.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.has_NBFIX" title="parmed.structure.Structure.has_NBFIX"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_NBFIX</span></code></a>()</p></td>
<td><p>Returns whether or not any pairs of atom types have their LJ interactions modified by an NBFIX definition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.is_changed" title="parmed.structure.Structure.is_changed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_changed</span></code></a>()</p></td>
<td><p>Determines if any of the topology has changed for this structure</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.join_dihedrals" title="parmed.structure.Structure.join_dihedrals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_dihedrals</span></code></a>()</p></td>
<td><p>Joins multi-term torsions into a single term and makes all of the parameters DihedralTypeList instances.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.load_dataframe" title="parmed.structure.Structure.load_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_dataframe</span></code></a>(df)</p></td>
<td><p>Loads atomic properties from an input DataFrame</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_add_constraints" title="parmed.structure.Structure.omm_add_constraints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_add_constraints</span></code></a>(system, constraints, …)</p></td>
<td><p>Adds constraints to a given system</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_angle_force" title="parmed.structure.Structure.omm_angle_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_angle_force</span></code></a>([constraints, …])</p></td>
<td><p>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the angles are for an Amoeba-parametrized system)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_bond_force" title="parmed.structure.Structure.omm_bond_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_bond_force</span></code></a>([constraints, rigidWater, …])</p></td>
<td><p>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are for an Amoeba-parametrized system)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_cmap_force" title="parmed.structure.Structure.omm_cmap_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_cmap_force</span></code></a>()</p></td>
<td><p>Creates the OpenMM CMAP torsion force</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_dihedral_force" title="parmed.structure.Structure.omm_dihedral_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_dihedral_force</span></code></a>([split])</p></td>
<td><p>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_gbsa_force" title="parmed.structure.Structure.omm_gbsa_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_gbsa_force</span></code></a>(implicitSolvent[, …])</p></td>
<td><p>Creates a Generalized Born force for running implicit solvent calculations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_improper_force" title="parmed.structure.Structure.omm_improper_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_improper_force</span></code></a>()</p></td>
<td><p>Creates the OpenMM improper torsion force (quadratic bias)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_nonbonded_force" title="parmed.structure.Structure.omm_nonbonded_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_nonbonded_force</span></code></a>([nonbondedMethod, …])</p></td>
<td><p>Creates the OpenMM NonbondedForce instance</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_out_of_plane_bend_force" title="parmed.structure.Structure.omm_out_of_plane_bend_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_out_of_plane_bend_force</span></code></a>()</p></td>
<td><p>Creates the Amoeba out-of-plane bend force</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_pi_torsion_force" title="parmed.structure.Structure.omm_pi_torsion_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_pi_torsion_force</span></code></a>()</p></td>
<td><p>Creates the Amoeba pi-torsion force</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_rb_torsion_force" title="parmed.structure.Structure.omm_rb_torsion_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_rb_torsion_force</span></code></a>()</p></td>
<td><p>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_set_virtual_sites" title="parmed.structure.Structure.omm_set_virtual_sites"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_set_virtual_sites</span></code></a>(system)</p></td>
<td><p>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra points defined in this system</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_stretch_bend_force" title="parmed.structure.Structure.omm_stretch_bend_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_stretch_bend_force</span></code></a>()</p></td>
<td><p>Create the OpenMM Amoeba stretch-bend force for this system</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_torsion_torsion_force" title="parmed.structure.Structure.omm_torsion_torsion_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_torsion_torsion_force</span></code></a>()</p></td>
<td><p>Create the OpenMM Amoeba coupled-torsion (CMAP) force</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_trigonal_angle_force" title="parmed.structure.Structure.omm_trigonal_angle_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_trigonal_angle_force</span></code></a>()</p></td>
<td><p>Creates the Amoeba trigonal-angle force</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.omm_urey_bradley_force" title="parmed.structure.Structure.omm_urey_bradley_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_urey_bradley_force</span></code></a>()</p></td>
<td><p>Creates the OpenMM Urey-Bradley force</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.prune_empty_terms" title="parmed.structure.Structure.prune_empty_terms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prune_empty_terms</span></code></a>()</p></td>
<td><p>Looks through all of the topological lists and gets rid of terms in which at least one of the atoms is None or has an <cite>idx</cite> attribute set to -1 (indicating that it has been removed from the <cite>atoms</cite> atom list)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.save" title="parmed.structure.Structure.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(fname[, format, overwrite])</p></td>
<td><p>Saves the current Structure in the requested file format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.split" title="parmed.structure.Structure.split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code></a>()</p></td>
<td><p>Split the current Structure into separate Structure instances for each unique molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.strip" title="parmed.structure.Structure.strip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">strip</span></code></a>(selection)</p></td>
<td><p>Deletes a subset of the atoms corresponding to an atom-based selection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.to_dataframe" title="parmed.structure.Structure.to_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dataframe</span></code></a>()</p></td>
<td><p>Generates a DataFrame from the current Structure’s atomic properties</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.unchange" title="parmed.structure.Structure.unchange"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unchange</span></code></a>()</p></td>
<td><p>Toggles all lists so that they do not indicate any changes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.update_dihedral_exclusions" title="parmed.structure.Structure.update_dihedral_exclusions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_dihedral_exclusions</span></code></a>()</p></td>
<td><p>Nonbonded exclusions and exceptions have the following priority:</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.visualize" title="parmed.structure.Structure.visualize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize</span></code></a>(*args, **kwargs)</p></td>
<td><p>Use nglview for visualization.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.write_cif" title="parmed.structure.Structure.write_cif"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_cif</span></code></a>(dest[, renumber, coordinates, …])</p></td>
<td><p>Write a PDB file from the current Structure instance</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.Structure.write_pdb" title="parmed.structure.Structure.write_pdb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_pdb</span></code></a>(dest[, renumber, coordinates, …])</p></td>
<td><p>Write a PDB file from a Structure instance</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.Structure.write_psf" title="parmed.structure.Structure.write_psf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_psf</span></code></a>(dest[, vmd])</p></td>
<td><p>Writes a PSF file from the stored molecule</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="parmed.structure.Structure.ANGLE_FORCE_GROUP">
<code class="sig-name descname">ANGLE_FORCE_GROUP</code><em class="property"> = 1</em><a class="headerlink" href="#parmed.structure.Structure.ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.BOND_FORCE_GROUP">
<code class="sig-name descname">BOND_FORCE_GROUP</code><em class="property"> = 0</em><a class="headerlink" href="#parmed.structure.Structure.BOND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.CMAP_FORCE_GROUP">
<code class="sig-name descname">CMAP_FORCE_GROUP</code><em class="property"> = 5</em><a class="headerlink" href="#parmed.structure.Structure.CMAP_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.DIHEDRAL_FORCE_GROUP">
<code class="sig-name descname">DIHEDRAL_FORCE_GROUP</code><em class="property"> = 2</em><a class="headerlink" href="#parmed.structure.Structure.DIHEDRAL_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.IMPROPER_FORCE_GROUP">
<code class="sig-name descname">IMPROPER_FORCE_GROUP</code><em class="property"> = 4</em><a class="headerlink" href="#parmed.structure.Structure.IMPROPER_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.NONBONDED_FORCE_GROUP">
<code class="sig-name descname">NONBONDED_FORCE_GROUP</code><em class="property"> = 11</em><a class="headerlink" href="#parmed.structure.Structure.NONBONDED_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.OUT_OF_PLANE_BEND_FORCE_GROUP">
<code class="sig-name descname">OUT_OF_PLANE_BEND_FORCE_GROUP</code><em class="property"> = 7</em><a class="headerlink" href="#parmed.structure.Structure.OUT_OF_PLANE_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.PI_TORSION_FORCE_GROUP">
<code class="sig-name descname">PI_TORSION_FORCE_GROUP</code><em class="property"> = 8</em><a class="headerlink" href="#parmed.structure.Structure.PI_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.RB_TORSION_FORCE_GROUP">
<code class="sig-name descname">RB_TORSION_FORCE_GROUP</code><em class="property"> = 12</em><a class="headerlink" href="#parmed.structure.Structure.RB_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.STRETCH_BEND_FORCE_GROUP">
<code class="sig-name descname">STRETCH_BEND_FORCE_GROUP</code><em class="property"> = 9</em><a class="headerlink" href="#parmed.structure.Structure.STRETCH_BEND_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.TORSION_TORSION_FORCE_GROUP">
<code class="sig-name descname">TORSION_TORSION_FORCE_GROUP</code><em class="property"> = 10</em><a class="headerlink" href="#parmed.structure.Structure.TORSION_TORSION_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.TRIGONAL_ANGLE_FORCE_GROUP">
<code class="sig-name descname">TRIGONAL_ANGLE_FORCE_GROUP</code><em class="property"> = 6</em><a class="headerlink" href="#parmed.structure.Structure.TRIGONAL_ANGLE_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="parmed.structure.Structure.UREY_BRADLEY_FORCE_GROUP">
<code class="sig-name descname">UREY_BRADLEY_FORCE_GROUP</code><em class="property"> = 3</em><a class="headerlink" href="#parmed.structure.Structure.UREY_BRADLEY_FORCE_GROUP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.add_atom">
<code class="sig-name descname">add_atom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em>, <em class="sig-param"><span class="n">resname</span></em>, <em class="sig-param"><span class="n">resnum</span></em>, <em class="sig-param"><span class="n">chain</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">inscode</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">segid</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.add_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if
it has a different name or number as the last residue added and adding
it to the <cite>atoms</cite> list.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>atom</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></span></dt><dd><p>The atom to add to this residue list</p>
</dd>
<dt><strong>resname</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>The name of the residue this atom belongs to</p>
</dd>
<dt><strong>resnum</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>The number of the residue this atom belongs to</p>
</dd>
<dt><strong>chain</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>The chain ID character for this residue</p>
</dd>
<dt><strong>inscode</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>The insertion code ID character for this residue (it is stripped)</p>
</dd>
<dt><strong>segid</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>The segment identifier for this residue (it is stripped)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the residue name and number differ from the last residue in this
list, a new residue is added and the atom is added to that residue</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.add_atom_to_residue">
<code class="sig-name descname">add_atom_to_residue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em>, <em class="sig-param"><span class="n">residue</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.add_atom_to_residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.add_atom_to_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new atom to the Structure at the end if the given residue</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>atom</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></span></dt><dd><p>The atom to add to the system</p>
</dd>
<dt><strong>residue</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></span></dt><dd><p>The residue to which to add this atom. It MUST be part of this
Structure instance already or a ValueError is raised</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This atom is added at the end of the residue and is inserted into the
<cite>atoms</cite> list in such a way that all residues are composed of atoms
contiguous in the atoms list. For large systems, this may be a
relatively expensive operation</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.assign_bonds">
<code class="sig-name descname">assign_bonds</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">reslibs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.assign_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.assign_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns bonds to all atoms based on the provided residue template
libraries. Atoms whose names are <em>not</em> in the templates, as well as
those residues for whom no template is found, is assigned to bonds based
on distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>reslibs</strong><span class="classifier">dict{str: ResidueTemplate}</span></dt><dd><p>Any number of residue template libraries. By default, assign_bonds
knows about the standard amino acid, RNA, and DNA residues.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.box">
<em class="property">property </em><code class="sig-name descname">box</code><a class="headerlink" href="#parmed.structure.Structure.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.box_vectors">
<em class="property">property </em><code class="sig-name descname">box_vectors</code><a class="headerlink" href="#parmed.structure.Structure.box_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>3, 3-element tuple of unit cell vectors that are Quantity objects of
dimension length</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.combining_rule">
<em class="property">property </em><code class="sig-name descname">combining_rule</code><a class="headerlink" href="#parmed.structure.Structure.combining_rule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.coordinates">
<em class="property">property </em><code class="sig-name descname">coordinates</code><a class="headerlink" href="#parmed.structure.Structure.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cls</span></em>, <em class="sig-param"><span class="n">split_dihedrals</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a copy of the current structure as an instance of a specified
subclass</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>cls</strong><span class="classifier">Structure subclass</span></dt><dd><p>The returned object is a copy of this structure as a <cite>cls</cite> instance</p>
</dd>
<dt><strong>split_dihedrals</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, then the Dihedral entries will be split up so that each one
is paired with a single DihedralType (rather than a
DihedralTypeList)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><em>cls</em> instance</dt><dd><p>The instance of the Structure subclass <cite>cls</cite> with a copy of the
current Structure’s topology information</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.createSystem">
<code class="sig-name descname">createSystem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nonbondedMethod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nonbondedCutoff</span><span class="o">=</span><span class="default_value">Quantity(value=8.0, unit=angstrom)</span></em>, <em class="sig-param"><span class="n">switchDistance</span><span class="o">=</span><span class="default_value">Quantity(value=0.0, unit=angstrom)</span></em>, <em class="sig-param"><span class="n">constraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rigidWater</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">implicitSolvent</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">implicitSolventKappa</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">implicitSolventSaltConc</span><span class="o">=</span><span class="default_value">Quantity(value=0.0, unit=mole / liter)</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">Quantity(value=298.15, unit=kelvin)</span></em>, <em class="sig-param"><span class="n">soluteDielectric</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">solventDielectric</span><span class="o">=</span><span class="default_value">78.5</span></em>, <em class="sig-param"><span class="n">useSASA</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">removeCMMotion</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">hydrogenMass</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ewaldErrorTolerance</span><span class="o">=</span><span class="default_value">0.0005</span></em>, <em class="sig-param"><span class="n">flexibleConstraints</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">splitDihedrals</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.createSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.createSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an OpenMM System representing the topology described by the
prmtop file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nonbondedMethod</strong><span class="classifier">cutoff method</span></dt><dd><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</dd>
<dt><strong>nonbondedCutoff</strong><span class="classifier">float or distance Quantity</span></dt><dd><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</dd>
<dt><strong>switchDistance</strong><span class="classifier">float or distance Quantity</span></dt><dd><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</dd>
<dt><strong>constraints</strong><span class="classifier">None, app.HBonds, app.HAngles, or app.AllBonds</span></dt><dd><p>Which type of constraints to add to the system (e.g., SHAKE). None
means no bonds are constrained. HBonds means bonds with hydrogen are
constrained</p>
</dd>
<dt><strong>rigidWater</strong><span class="classifier">bool=True</span></dt><dd><p>If True, water is kept rigid regardless of the value of constraints.
A value of False is ignored if constraints is not None.</p>
</dd>
<dt><strong>implicitSolvent</strong><span class="classifier">None, app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</span></dt><dd><p>The Generalized Born implicit solvent model to use.</p>
</dd>
<dt><strong>implicitSolventKappa</strong><span class="classifier">float or 1/distance Quantity = None</span></dt><dd><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</dd>
<dt><strong>implicitSolventSaltConc</strong><span class="classifier">float or amount/volume Quantity=0 moles/liter</span></dt><dd><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">float or temperature Quantity = 298.15 kelvin</span></dt><dd><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</dd>
<dt><strong>soluteDielectric</strong><span class="classifier">float=1.0</span></dt><dd><p>The dielectric constant of the protein interior used in GB</p>
</dd>
<dt><strong>solventDielectric</strong><span class="classifier">float=78.5</span></dt><dd><p>The dielectric constant of the water used in GB</p>
</dd>
<dt><strong>useSASA</strong><span class="classifier">bool=False</span></dt><dd><p>If True, use the ACE non-polar solvation model. Otherwise, use no
SASA-based nonpolar solvation model.</p>
</dd>
<dt><strong>removeCMMotion</strong><span class="classifier">bool=True</span></dt><dd><p>If True, the center-of-mass motion will be removed periodically
during the simulation. If False, it will not.</p>
</dd>
<dt><strong>hydrogenMass</strong><span class="classifier">float or mass quantity = None</span></dt><dd><p>If not None, hydrogen masses will be changed to this mass and the
difference subtracted from the attached heavy atom (hydrogen mass
repartitioning)</p>
</dd>
<dt><strong>ewaldErrorTolerance</strong><span class="classifier">float=0.0005</span></dt><dd><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</dd>
<dt><strong>flexibleConstraints</strong><span class="classifier">bool=True</span></dt><dd><p>If False, the energies and forces from the constrained degrees of
freedom will NOT be computed. If True, they will (but those degrees
of freedom will <em>still</em> be constrained).</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool=False</span></dt><dd><p>If True, the progress of this subroutine will be printed to stdout</p>
</dd>
<dt><strong>splitDihedrals</strong><span class="classifier">bool=False</span></dt><dd><p>If True, the dihedrals will be split into two forces – proper and
impropers. This is primarily useful for debugging torsion parameter
assignments.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calls prune_empty_terms if any Topology lists have changed</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.get_box">
<code class="sig-name descname">get_box</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frame</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.get_box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.get_box" title="Permalink to this definition">¶</a></dt>
<dd><p>In some cases, multiple conformations may be stored in the Structure.
This function retrieves a particular frame’s unit cell (box) dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame</strong><span class="classifier">int or ‘all’, optional</span></dt><dd><p>The frame number whose unit cell should be retrieved. Default is
‘all’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>box</strong><span class="classifier">np.ndarray, shape([#,] 6) or None</span></dt><dd><p>If frame is ‘all’, all unit cells are returned with shape
(#, 6). Otherwise the requested frame is returned with shape
(6,). If no unit cell exist and ‘all’ is requested, None is
returned</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>IndexError if there are fewer than <code class="docutils literal notranslate"><span class="pre">frame</span></code> unit cell dimensions</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.get_coordinates">
<code class="sig-name descname">get_coordinates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frame</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.get_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.get_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>In some cases, multiple conformations may be stored in the Structure.
This function retrieves a particular frame’s coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>frame</strong><span class="classifier">int or ‘all’, optional</span></dt><dd><p>The frame number whose coordinates should be retrieved. Default is
‘all’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>coords</strong><span class="classifier">np.ndarray, shape([#,] natom, 3) or None</span></dt><dd><p>If frame is ‘all’, all coordinates are returned with shape
(#, natom, 3). Otherwise the requested frame is returned with shape
(natom, 3). If no coordinates exist and ‘all’ is requested, None is
returned</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>IndexError if there are fewer than <code class="docutils literal notranslate"><span class="pre">frame</span></code> coordinates</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.has_NBFIX">
<code class="sig-name descname">has_NBFIX</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.has_NBFIX"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.has_NBFIX" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not any pairs of atom types have their LJ
interactions modified by an NBFIX definition</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>has_nbfix</strong><span class="classifier">bool</span></dt><dd><p>If True, at least two atom types have NBFIX mod definitions</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.is_changed">
<code class="sig-name descname">is_changed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.is_changed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.is_changed" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if any of the topology has changed for this structure</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.join_dihedrals">
<code class="sig-name descname">join_dihedrals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.join_dihedrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.join_dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Joins multi-term torsions into a single term and makes all of the
parameters DihedralTypeList instances. If any dihedrals are <em>already</em>
DihedralTypeList instances, or any are not parametrized, or there are no
dihedral_types, this method returns without doing anything</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.load_dataframe">
<code class="sig-name descname">load_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.load_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.load_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atomic properties from an input DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas DataFrame with atomic properties that will be used to set
the properties on the current list of atoms</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.load_dataframe" title="parmed.utils.pandautils.load_dataframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">parmed.utils.pandautils.load_dataframe()</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_add_constraints">
<code class="sig-name descname">omm_add_constraints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">system</span></em>, <em class="sig-param"><span class="n">constraints</span></em>, <em class="sig-param"><span class="n">rigidWater</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_add_constraints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_add_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints to a given system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>system</strong><span class="classifier">mm.System</span></dt><dd><p>The OpenMM system for which constraints should be added</p>
</dd>
<dt><strong>constraints</strong><span class="classifier">None, app.HBonds, app.AllBonds, or app.HAngles</span></dt><dd><p>Which kind of constraints should be used</p>
</dd>
<dt><strong>rigidWater</strong><span class="classifier">bool</span></dt><dd><p>If True, water bonds are constrained regardless of whether
constrains is None</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_angle_force">
<code class="sig-name descname">omm_angle_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">constraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flexibleConstraints</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_angle_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the
angles are for an Amoeba-parametrized system)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>constraints</strong><span class="classifier">None, app.HBonds, app.AllBonds, or app.HAngles</span></dt><dd><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</dd>
<dt><strong>flexibleConstraints</strong><span class="classifier">bool=True</span></dt><dd><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>force</dt><dd><p>HarmonicAngleForce (or AmoebaAngleForce if this is an Amoeba
system), or None if there are no angles to add</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_bond_force">
<code class="sig-name descname">omm_bond_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">constraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rigidWater</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">flexibleConstraints</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_bond_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_bond_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are
for an Amoeba-parametrized system)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>constraints</strong><span class="classifier">None, app.HBonds, app.AllBonds, or app.HAngles</span></dt><dd><p>The types of constraints that are on the system. If
flexibleConstraints is False, then the constrained bonds will not be
added to the resulting Force</p>
</dd>
<dt><strong>rigidWater</strong><span class="classifier">bool=True</span></dt><dd><p>Should water-H bonds be constrained regardless of <cite>constraints</cite>?</p>
</dd>
<dt><strong>flexibleConstraints</strong><span class="classifier">bool=True</span></dt><dd><p>If True, all bonds are added to the force regardless of
<cite>constraints</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>force</dt><dd><p>HarmonicBondForce (or AmoebaBondForce if this is an Amoeba system),
or None if there are no bonds to add</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_cmap_force">
<code class="sig-name descname">omm_cmap_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_cmap_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_cmap_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM CMAP torsion force</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>CMAPTorsionForce</dt><dd><p>Or None, if no CMAP terms are present</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_dihedral_force">
<code class="sig-name descname">omm_dihedral_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">split</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_dihedral_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_dihedral_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>split</strong><span class="classifier">bool, optional, default=False</span></dt><dd><p>If True, separate PeriodicTorsionForce instances with the propers in
the first and impropers in the second return item. If no impropers
or propers are present, the instances with zero terms are not
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>PeriodicTorsionForce[, PeriodicTorsionForce]</dt><dd><p>Or None if no torsions are present in this system</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_gbsa_force">
<code class="sig-name descname">omm_gbsa_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">implicitSolvent</span></em>, <em class="sig-param"><span class="n">nonbondedMethod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nonbondedCutoff</span><span class="o">=</span><span class="default_value">Quantity(value=30.0, unit=angstrom)</span></em>, <em class="sig-param"><span class="n">soluteDielectric</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">solventDielectric</span><span class="o">=</span><span class="default_value">78.5</span></em>, <em class="sig-param"><span class="n">implicitSolventKappa</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">implicitSolventSaltConc</span><span class="o">=</span><span class="default_value">Quantity(value=0.0, unit=mole / liter)</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">Quantity(value=298.15, unit=kelvin)</span></em>, <em class="sig-param"><span class="n">useSASA</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_gbsa_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_gbsa_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Generalized Born force for running implicit solvent
calculations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>implicitSolvent</strong><span class="classifier">app.HCT, app.OBC1, app.OBC2, app.GBn, app.GBn2</span></dt><dd><p>The Generalized Born implicit solvent model to use.</p>
</dd>
<dt><strong>nonbondedMethod</strong><span class="classifier">cutoff method</span></dt><dd><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace. Default is NoCutoff</p>
</dd>
<dt><strong>nonbondedCutoff</strong><span class="classifier">float or distance Quantity</span></dt><dd><p>The nonbonded cutoff must be either a floating opint number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff</p>
</dd>
<dt><strong>implicitSolventKappa</strong><span class="classifier">float or 1/distance Quantity = None</span></dt><dd><p>This is the Debye kappa property related to modeling saltwater
conditions in GB. It should have units of 1/distance (1/nanometers
is assumed if no units present). A value of None means that kappa
will be calculated from implicitSolventSaltConc (below)</p>
</dd>
<dt><strong>implicitSolventSaltConc</strong><span class="classifier">float or amount/volume Quantity=0 moles/liter</span></dt><dd><p>If implicitSolventKappa is None, the kappa will be computed from the
salt concentration. It should have units compatible with mol/L</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">float or temperature Quantity = 298.15 kelvin</span></dt><dd><p>This is only used to compute kappa from implicitSolventSaltConc</p>
</dd>
<dt><strong>soluteDielectric</strong><span class="classifier">float=1.0</span></dt><dd><p>The dielectric constant of the protein interior used in GB</p>
</dd>
<dt><strong>solventDielectric</strong><span class="classifier">float=78.5</span></dt><dd><p>The dielectric constant of the water used in GB</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_improper_force">
<code class="sig-name descname">omm_improper_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_improper_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_improper_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM improper torsion force (quadratic bias)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>CustomTorsionForce</dt><dd><p>With the formula k*(phi-phi0)^2, or None if there are no impropers</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_nonbonded_force">
<code class="sig-name descname">omm_nonbonded_force</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nonbondedMethod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nonbondedCutoff</span><span class="o">=</span><span class="default_value">Quantity(value=8, unit=angstrom)</span></em>, <em class="sig-param"><span class="n">switchDistance</span><span class="o">=</span><span class="default_value">Quantity(value=0, unit=angstrom)</span></em>, <em class="sig-param"><span class="n">ewaldErrorTolerance</span><span class="o">=</span><span class="default_value">0.0005</span></em>, <em class="sig-param"><span class="n">reactionFieldDielectric</span><span class="o">=</span><span class="default_value">78.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_nonbonded_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_nonbonded_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM NonbondedForce instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nonbondedMethod</strong><span class="classifier">cutoff method</span></dt><dd><p>This is the cutoff method. It can be either the NoCutoff,
CutoffNonPeriodic, CutoffPeriodic, PME, or Ewald objects from the
simtk.openmm.app namespace</p>
</dd>
<dt><strong>nonbondedCutoff</strong><span class="classifier">float or distance Quantity</span></dt><dd><p>The nonbonded cutoff must be either a floating point number
(interpreted as nanometers) or a Quantity with attached units. This
is ignored if nonbondedMethod is NoCutoff.</p>
</dd>
<dt><strong>switchDistance</strong><span class="classifier">float or distance Quantity</span></dt><dd><p>The distance at which the switching function is turned on for van
der Waals interactions. This is ignored when no cutoff is used, and
no switch is used if switchDistance is 0, negative, or greater than
the cutoff</p>
</dd>
<dt><strong>ewaldErrorTolerance</strong><span class="classifier">float=0.0005</span></dt><dd><p>When using PME or Ewald, the Ewald parameters will be calculated
from this value</p>
</dd>
<dt><strong>reactionFieldDielectric</strong><span class="classifier">float=78.5</span></dt><dd><p>If the nonbondedMethod is CutoffPeriodic or CutoffNonPeriodic, the
region beyond the cutoff is treated using a reaction field method
with this dielectric constant. It should be set to 1 if another
implicit solvent model is being used (e.g., GB)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>NonbondedForce</dt><dd><p>This just implements the very basic NonbondedForce with the typical
charge-charge and 12-6 Lennard-Jones interactions with the
Lorentz-Berthelot combining rules.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Subclasses of Structure for which this nonbonded treatment is inadequate
should override this method to implement what is needed.</p>
<p>If nrexcl is set to 3 and no exception parameters are stored in the
adjusts list, the 1-4 interactions are determined from the list of
dihedrals</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_out_of_plane_bend_force">
<code class="sig-name descname">omm_out_of_plane_bend_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_out_of_plane_bend_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_out_of_plane_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba out-of-plane bend force</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>AmoebaOutOfPlaneBendForce</dt><dd><p>The out-of-plane bend Angle force</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_pi_torsion_force">
<code class="sig-name descname">omm_pi_torsion_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_pi_torsion_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_pi_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba pi-torsion force</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>AmoebaPiTorsionForce</dt><dd><p>The pi-torsion force</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_rb_torsion_force">
<code class="sig-name descname">omm_rb_torsion_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_rb_torsion_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_rb_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>RBTorsionForce</dt><dd><p>Or None if no torsions are present in this system</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_set_virtual_sites">
<code class="sig-name descname">omm_set_virtual_sites</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">system</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_set_virtual_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_set_virtual_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra
points defined in this system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>system</strong><span class="classifier">mm.System</span></dt><dd><p>The system for which the virtual sites will be set. All particles
must have already been added to this System before calling this
method</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_stretch_bend_force">
<code class="sig-name descname">omm_stretch_bend_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_stretch_bend_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_stretch_bend_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba stretch-bend force for this system</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>AmoebaStretchBendForce</dt><dd><p>The stretch-bend force containing all terms in this system</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_torsion_torsion_force">
<code class="sig-name descname">omm_torsion_torsion_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_torsion_torsion_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_torsion_torsion_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the OpenMM Amoeba coupled-torsion (CMAP) force</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>AmoebaTorsionTorsionForce</dt><dd><p>The torsion-torsion (CMAP) force with all coupled-torsion parameters
for this system</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_trigonal_angle_force">
<code class="sig-name descname">omm_trigonal_angle_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_trigonal_angle_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_trigonal_angle_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the Amoeba trigonal-angle force</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>AmoebaInPlaneAngleForce</dt><dd><p>The trigonal in-plane Angle force</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.omm_urey_bradley_force">
<code class="sig-name descname">omm_urey_bradley_force</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.omm_urey_bradley_force"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.omm_urey_bradley_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the OpenMM Urey-Bradley force</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>HarmonicBondForce</dt><dd><p>Or None, if no urey-bradleys are present</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.positions">
<em class="property">property </em><code class="sig-name descname">positions</code><a class="headerlink" href="#parmed.structure.Structure.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of 3-element Quantity tuples of dimension length representing the
atomic positions for every atom in the system. If set with unitless
numbers, those numbers are assumed to be in angstroms. If any atoms do
not have coordinates, this is simply <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.prune_empty_terms">
<code class="sig-name descname">prune_empty_terms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.prune_empty_terms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.prune_empty_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks through all of the topological lists and gets rid of terms
in which at least one of the atoms is None or has an <cite>idx</cite> attribute set
to -1 (indicating that it has been removed from the <cite>atoms</cite> atom list)</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current Structure in the requested file format. Supported
formats can be specified explicitly or determined by file-name
extension. The following formats are supported, with the recognized
suffix and <code class="docutils literal notranslate"><span class="pre">format</span></code> keyword shown in parentheses:</p>
<blockquote>
<div><ul class="simple">
<li><p>PDB (.pdb, pdb)</p></li>
<li><p>PDBx/mmCIF (.cif, cif)</p></li>
<li><p>PQR (.pqr, pqr)</p></li>
<li><p>Amber topology file (.prmtop/.parm7, amber)</p></li>
<li><p>CHARMM PSF file (.psf, psf)</p></li>
<li><p>CHARMM coordinate file (.crd, charmmcrd)</p></li>
<li><p>Gromacs topology file (.top, gromacs)</p></li>
<li><p>Gromacs GRO file (.gro, gro)</p></li>
<li><p>Mol2 file (.mol2, mol2)</p></li>
<li><p>Mol3 file (.mol3, mol3)</p></li>
<li><p>Amber ASCII restart (.rst7/.inpcrd/.restrt, rst7)</p></li>
<li><p>Amber NetCDF restart (.ncrst, ncrst)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fname</strong><span class="classifier">str or file-like object</span></dt><dd><p>Name of the file or file-like object to save. If <code class="docutils literal notranslate"><span class="pre">format</span></code> is
<code class="docutils literal notranslate"><span class="pre">None</span></code> (see below), the file type will be determined based on
the filename extension. If <code class="docutils literal notranslate"><span class="pre">fname</span></code> is file-like object,  <code class="docutils literal notranslate"><span class="pre">format</span></code>
must be  provided. If the type cannot be determined, a ValueError is raised.</p>
</dd>
<dt><strong>format</strong><span class="classifier">str, optional</span></dt><dd><p>The case-insensitive keyword specifying what type of file <code class="docutils literal notranslate"><span class="pre">fname</span></code>
should be saved as. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), the file type will be
determined from filename extension of <code class="docutils literal notranslate"><span class="pre">fname</span></code></p>
</dd>
<dt><strong>overwrite</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, allow the target file to be overwritten. Otherwise, an
IOError is raised if the file exists. Default is False</p>
</dd>
<dt><strong>kwargs</strong><span class="classifier">keyword-arguments</span></dt><dd><p>Remaining arguments are passed on to the file writing routines that
are called by this function</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError if either filename extension or <code class="docutils literal notranslate"><span class="pre">format</span></code> are not recognized</dt><dd></dd>
<dt>TypeError if the structure cannot be converted to the desired format for</dt><dd></dd>
<dt>whatever reason</dt><dd></dd>
<dt>IOError if the file cannot be written either because it exists and</dt><dd></dd>
<dt><code class="docutils literal notranslate"><span class="pre">overwrite</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the filesystem is read-only, or write</dt><dd></dd>
<dt>permissions are not granted for the user</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the current Structure into separate Structure instances for each
unique molecule. A molecule is defined as all atoms connected by a graph
of covalent bonds.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>[structs, counts]</strong><span class="classifier">list of (<a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a>, list) tuples</span></dt><dd><p>List of all molecules in the order that they appear first in the
parent structure accompanied by the list of the molecule numbers
in which that molecule appears in the Structure</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.strip">
<code class="sig-name descname">strip</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">selection</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.strip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a subset of the atoms corresponding to an atom-based selection.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>selection</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">AmberMask</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, or <code class="docutils literal notranslate"><span class="pre">iterable</span></code></span></dt><dd><p>This is the selection of atoms that will be deleted from this
structure. If it is a string, it will be interpreted as an
AmberMask. If it is an AmberMask, it will be converted to a
selection of atoms. If it is an iterable, it must be the same length
as the <cite>atoms</cite> list.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.to_dataframe">
<code class="sig-name descname">to_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a DataFrame from the current Structure’s atomic properties</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">DataFrame</span></dt><dd><p>DataFrame with all atomic properties</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.create_dataframe" title="parmed.utils.pandautils.create_dataframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">parmed.utils.pandautils.create_dataframe()</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.topology">
<em class="property">property </em><code class="sig-name descname">topology</code><a class="headerlink" href="#parmed.structure.Structure.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>The OpenMM Topology object. Cached when possible, but any changes to the
Structure instance results in the topology being deleted and rebuilt</p>
<p class="rubric">Notes</p>
<p>This function calls <code class="docutils literal notranslate"><span class="pre">prune_empty_terms</span></code> if any topology lists have
changed.</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.unchange">
<code class="sig-name descname">unchange</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.unchange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.unchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggles all lists so that they do not indicate any changes</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.update_dihedral_exclusions">
<code class="sig-name descname">update_dihedral_exclusions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.update_dihedral_exclusions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.update_dihedral_exclusions" title="Permalink to this definition">¶</a></dt>
<dd><p>Nonbonded exclusions and exceptions have the following priority:</p>
<p>bond -&gt; angle -&gt; dihedral</p>
<p>Since bonds and angles are completely excluded, any ring systems in
which two atoms are attached by a bond or angle as well as a dihedral
should be completely excluded as the bond and angle exclusion rules take
precedence.  If a Bond or Angle was _added_ to the structure between a
pair of atoms previously connected only by a dihedral term, it’s
possible that those two atoms have both an exclusion <em>and</em> an exception
defined. The result of this scenario is that sander and pmemd will
happily compute an energy, _including_ the 1-4 nonbonded terms between
atoms now connected by a bond or an Angle.  OpenMM, on the other hand,
will complain about an exception specified multiple times. This method
scans through all of the dihedrals in which <cite>ignore_end</cite> is <cite>False</cite> and
turns it to <cite>True</cite> if the two end atoms are in the bond or angle
partners arrays</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.velocities">
<em class="property">property </em><code class="sig-name descname">velocities</code><a class="headerlink" href="#parmed.structure.Structure.velocities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.view">
<em class="property">property </em><code class="sig-name descname">view</code><a class="headerlink" href="#parmed.structure.Structure.view" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an indexable object that can be indexed like a standard
Structure, but returns a <em>view</em> rather than a copy</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Structure.__getitem__</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.visualize">
<code class="sig-name descname">visualize</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#Structure.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.Structure.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Use nglview for visualization. This only works with Jupyter notebook
and require to install <cite>nglview</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>args and kwargs</strong><span class="classifier">positional and keyword arguments given to nglview, optional</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">parmed</span> <span class="k">as</span> <span class="nn">pmd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parm</span> <span class="o">=</span> <span class="n">pmd</span><span class="o">.</span><span class="n">download_PDB</span><span class="p">(</span><span class="s1">&#39;1tsu&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parm</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.write_cif">
<code class="sig-name descname">write_cif</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dest</span></em>, <em class="sig-param"><span class="n">renumber</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">coordinates</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">altlocs</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">write_anisou</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">standard_resnames</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#parmed.structure.Structure.write_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from the current Structure instance</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>struct</strong><span class="classifier"><a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a></span></dt><dd><p>The structure from which to write the PDBx/mmCIF file</p>
</dd>
<dt><strong>dest</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">or</span> <span class="pre">file-like</span></code></span></dt><dd><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</dd>
<dt><strong>renumber</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">array-like</span> <span class="pre">of</span> <span class="pre">float</span></code></span></dt><dd><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the “original” PDB file if they
differ)</p>
</dd>
<dt><strong>altlocs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘all’ : (default) print all alternate locations</p></li>
<li><p>‘first’ : print only the first alternate locations</p></li>
<li><p>‘occupancy’ : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</p></li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</dd>
<dt><strong>write_anisou</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written</p>
</dd>
<dt><strong>standard_resnames</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values. Default is False</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If multiple coordinate frames are present, these will be written as
separate models (but only the unit cell from the first model will be
written, as the PDBx standard dictates that only one set of unit cells
shall be present).</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.write_pdb">
<code class="sig-name descname">write_pdb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dest</span></em>, <em class="sig-param"><span class="n">renumber</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">coordinates</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">altlocs</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">write_anisou</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">charmm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_hetatoms</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">standard_resnames</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">increase_tercount</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">write_links</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#parmed.structure.Structure.write_pdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a PDB file from a Structure instance</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>struct</strong><span class="classifier"><a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a></span></dt><dd><p>The structure from which to write the PDB file</p>
</dd>
<dt><strong>dest</strong><span class="classifier">str or file-like</span></dt><dd><p>Either a file name or a file-like object containing a <cite>write</cite>
method to which to write the PDB file. If it is a filename that
ends with .gz or .bz2, a compressed version will be written using
either gzip or bzip2, respectively.</p>
</dd>
<dt><strong>renumber</strong><span class="classifier">bool, optional, default True</span></dt><dd><p>If True, renumber the atoms and residues sequentially as they are
stored in the structure.  If False, use the original numbering if
it was assigned previously.</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier">array-like of float, optional</span></dt><dd><p>If provided, these coordinates will be written to the PDB file
instead of the coordinates stored in the structure. These
coordinates should line up with the atom order in the structure
(not necessarily the order of the “original” PDB file if they
differ)</p>
</dd>
<dt><strong>altlocs</strong><span class="classifier">str, optional, default ‘all’</span></dt><dd><p>Keyword controlling which alternate locations are printed to the
resulting PDB file. Allowable options are:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘all’ : print all alternate locations</p></li>
<li><p>‘first’ : print only the first alternate locations</p></li>
<li><p>‘occupancy’ : print the one with the largest occupancy. If two
conformers have the same occupancy, the first one to occur is
printed</p></li>
</ul>
</div></blockquote>
<p>Input is case-insensitive, and partial strings are permitted as long
as it is a substring of one of the above options that uniquely
identifies the choice.</p>
</dd>
<dt><strong>write_anisou</strong><span class="classifier">bool, optional, default False</span></dt><dd><p>If True, an ANISOU record is written for every atom that has one. If
False, ANISOU records are not written.</p>
</dd>
<dt><strong>charmm</strong><span class="classifier">bool, optional, default False</span></dt><dd><p>If True, SEGID will be written in columns 73 to 76 of the PDB file
in the typical CHARMM-style PDB output. This will be omitted for any
atom that does not contain a SEGID identifier.</p>
</dd>
<dt><strong>use_hetatoms: bool, optional, default True</strong></dt><dd><p>If True, certain atoms will have the HETATM tag instead of ATOM
as per the PDB-standard.</p>
</dd>
<dt><strong>standard_resnames</strong><span class="classifier">bool, optional, default False</span></dt><dd><p>If True, common aliases for various amino and nucleic acid residues
will be converted into the PDB-standard values.</p>
</dd>
<dt><strong>increase_tercount</strong><span class="classifier">bool, optional, default True</span></dt><dd><p>If True, the TER atom number field increased by one compared to
atom card preceding it; this conforms to PDB standard.</p>
</dd>
<dt><strong>write_links</strong><span class="classifier">bool, optional, default False</span></dt><dd><p>If True, any LINK records stored in the Structure will be written to
the LINK records near the top of the PDB file. If this is True, then
renumber <em>must</em> be False or a ValueError will be thrown</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If multiple coordinate frames are present, these will be written as
separate models (but only the unit cell from the first model will be
written, as the PDB standard dictates that only one set of unit cells
shall be present).</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.Structure.write_psf">
<code class="sig-name descname">write_psf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dest</span></em>, <em class="sig-param"><span class="n">vmd</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#parmed.structure.Structure.write_psf" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a PSF file from the stored molecule</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>struct</strong><span class="classifier"><a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a></span></dt><dd><p>The Structure instance from which the PSF should be written</p>
</dd>
<dt><strong>dest</strong><span class="classifier">str or file-like</span></dt><dd><p>The place to write the output PSF file.  If it has a “write”
attribute, it will be used to print the PSF file. Otherwise, it will
be treated like a string and a file will be opened, printed, then
closed</p>
</dd>
<dt><strong>vmd</strong><span class="classifier">bool</span></dt><dd><p>If True, it will write out a PSF in the format that VMD prints it in
(i.e., no NUMLP/NUMLPH or MOLNT sections)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">CharmmPsfFile</span><span class="p">(</span><span class="s1">&#39;testfiles/test.psf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">write_psf</span><span class="p">(</span><span class="s1">&#39;testfiles/test2.psf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="parmed.structure.StructureView">
<em class="property">class </em><code class="sig-prename descclassname">parmed.structure.</code><code class="sig-name descname">StructureView</code><a class="reference internal" href="../../_modules/parmed/structure.html#StructureView"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.StructureView" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A view of a Structure. In many cases, this can serve as a duck-typed
Structure and it has many of the same attributes. However, none of its lists
<em>own</em> their objects, and the lists of atoms, residues, and
parameters/topologies are regular lists, rather than TrackedList instances.
Therefore, the indexes correspond to the indexes from the <em>original</em>
Structure from which this view was taken. Furthermore, there are no “type”
lists, as they would be exactly equivalent to the type lists of the parent
Structure instance.</p>
<dl class="field-list">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl>
<dt><strong>atoms</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomList</span></code></span></dt><dd><p>List of all atoms in the structure</p>
</dd>
<dt><strong>residues</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueList</span></code></span></dt><dd><p>List of all residues in the structure</p>
</dd>
<dt><strong>bonds</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code>)</span></dt><dd><p>List of all bonds in the structure</p>
</dd>
<dt><strong>angles</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Angle</span></code>)</span></dt><dd><p>List of all angles in the structure</p>
</dd>
<dt><strong>dihedrals</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code>)</span></dt><dd><p>List of all dihedrals in the structure</p>
</dd>
<dt><strong>rb_torsions</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">RBTorsion</span></code>)</span></dt><dd><p>List of all Ryckaert-Bellemans torsions in the structure</p>
</dd>
<dt><strong>urey_bradleys</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UreyBradley</span></code>)</span></dt><dd><p>List of all Urey-Bradley angle bends in the structure</p>
</dd>
<dt><strong>impropers</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Improper</span></code>)</span></dt><dd><p>List of all CHARMM-style improper torsions in the structure</p>
</dd>
<dt><strong>cmaps</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Cmap</span></code>)</span></dt><dd><p>List of all CMAP objects in the structure</p>
</dd>
<dt><strong>trigonal_angles</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TrigonalAngle</span></code>)</span></dt><dd><p>List of all AMOEBA-style trigonal angles in the structure</p>
</dd>
<dt><strong>out_of_plane_bends</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">OutOfPlaneBends</span></code>)</span></dt><dd><p>List of all AMOEBA-style out-of-plane bending angles</p>
</dd>
<dt><strong>pi_torsions</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">PiTorsion</span></code>)</span></dt><dd><p>List of all AMOEBA-style pi-torsion angles</p>
</dd>
<dt><strong>stretch_bends</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">StretchBend</span></code>)</span></dt><dd><p>List of all AMOEBA-style stretch-bend compound bond/angle terms</p>
</dd>
<dt><strong>torsion_torsions</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TorsionTorsion</span></code>)</span></dt><dd><p>List of all AMOEBA-style coupled torsion-torsion terms</p>
</dd>
<dt><strong>chiral_frames</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ChiralFrame</span></code>)</span></dt><dd><p>List of all AMOEBA-style chiral frames defined in the structure</p>
</dd>
<dt><strong>multipole_frames</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MultipoleFrame</span></code>)</span></dt><dd><p>List of all AMOEBA-style multipole frames defined in the structure</p>
</dd>
<dt><strong>adjusts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NonbondedException</span></code>)</span></dt><dd><p>List of all nonbonded pair-exception rules</p>
</dd>
<dt><strong>acceptors</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AcceptorDonor</span></code>)</span></dt><dd><p>List of all H-bond acceptors, if that information is present</p>
</dd>
<dt><strong>donors</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrackedList</span></code> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AcceptorDonor</span></code>)</span></dt><dd><p>List of all H-bond donors, if that information is present</p>
</dd>
<dt><strong>positions</strong><span class="classifier">u.Quantity(list(Vec3), u.angstroms)</span></dt><dd><p>Unit-bearing atomic coordinates. If not all atoms have coordinates, this
property is None</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier">np.ndarray of shape (nframes, natom, 3)</span></dt><dd><p>If no coordinates are set, this is set to None. The first frame will
match the coordinates present on the atoms.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.structure.StructureView.load_dataframe" title="parmed.structure.StructureView.load_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_dataframe</span></code></a>(df)</p></td>
<td><p>Loads atomic properties from an input DataFrame</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.structure.StructureView.to_dataframe" title="parmed.structure.StructureView.to_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dataframe</span></code></a>()</p></td>
<td><p>Generates a DataFrame from the current Structure’s atomic properties</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="parmed.structure.StructureView.coordinates">
<em class="property">property </em><code class="sig-name descname">coordinates</code><a class="headerlink" href="#parmed.structure.StructureView.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.StructureView.load_dataframe">
<code class="sig-name descname">load_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#StructureView.load_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.StructureView.load_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads atomic properties from an input DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>A pandas DataFrame with atomic properties that will be used to set
the properties on the current list of atoms</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.load_dataframe" title="parmed.utils.pandautils.load_dataframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">parmed.utils.pandautils.load_dataframe()</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="parmed.structure.StructureView.positions">
<em class="property">property </em><code class="sig-name descname">positions</code><a class="headerlink" href="#parmed.structure.StructureView.positions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.structure.StructureView.to_dataframe">
<code class="sig-name descname">to_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/structure.html#StructureView.to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.structure.StructureView.to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a DataFrame from the current Structure’s atomic properties</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">DataFrame</span></dt><dd><p>DataFrame with all atomic properties</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="parmed.utils.pandautils.html#parmed.utils.pandautils.create_dataframe" title="parmed.utils.pandautils.create_dataframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">parmed.utils.pandautils.create_dataframe()</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Jason Swails

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>