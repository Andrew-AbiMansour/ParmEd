

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>parmed.charmm package &mdash; ParmEd  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> ParmEd
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.3319.g7a6168d
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../topologyobjects.html">Core classes used to represent topologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structure.html">The core Structure class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dimensional_analysis.html">Working with units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readwrite.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../amber.html">The Amber file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../charmm.html">The CHARMM file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gromacs.html">The GROMACS file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rosetta.html">PyRosetta Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed.html">Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed.html#using-xparmed">Using <code class="docutils literal notranslate"><span class="pre">xparmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed_api.html">The ParmEd API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openmm.html">OpenMM Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization.html">Visualization Functionality</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ParmEd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>parmed.charmm package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/parmed/parmed.charmm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="parmed-charmm-package">
<h1>parmed.charmm package<a class="headerlink" href="#parmed-charmm-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="parmed.charmm.charmmcrds.html">parmed.charmm.charmmcrds module</a></li>
<li class="toctree-l1"><a class="reference internal" href="parmed.charmm.parameters.html">parmed.charmm.parameters module</a></li>
<li class="toctree-l1"><a class="reference internal" href="parmed.charmm.psf.html">parmed.charmm.psf module</a></li>
</ul>
</div>
</div>
<div class="section" id="module-parmed.charmm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-parmed.charmm" title="Permalink to this headline">¶</a></h2>
<p>This package contains code for reading CHARMM structure files for setting up a
simulation with CHARMM; specifically PSF, PAR, RTF, and STR files</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>PAR<span class="classifier">Parameter file (PRM) – this contains all of the force field</span></dt><dd><p>parameters (e.g., bond lengths and strengths) for all of the atom
types</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>RTF<span class="classifier">Residue Topology File – this file contains the residue</span></dt><dd><p>connectivity tables as well as a definition of all of the atom
types. Also contains an internal coordinate representation of the
residues</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PSF<span class="classifier">Protein Structure File – this is the main file type in CHARMM</span></dt><dd><p>simulations that defines all of the residues in a system as well as
the atom types and connectivity between the atoms</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>STR<span class="classifier">Stream file – Source of additional information and CHARMM commands</span></dt><dd><p>that can contain RTF and PAR information. Allows users to define
additional parameters without ‘contaminating’ the original force
field parameter files</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="py class">
<dt id="parmed.charmm.CharmmCrdFile">
<em class="property">class </em><code class="sig-prename descclassname">parmed.charmm.</code><code class="sig-name descname">CharmmCrdFile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/charmmcrds.html#CharmmCrdFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmCrdFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads and parses a CHARMM coordinate file (.crd) into its components,
namely the coordinates, CHARMM atom types, resid, resname, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fname</strong><span class="classifier">str</span></dt><dd><p>Name of the restart file to parse</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>natom</strong><span class="classifier">int</span></dt><dd><p>Number of atoms in the system</p>
</dd>
<dt><strong>resname</strong><span class="classifier">list of str</span></dt><dd><p>List of all residue names in the system</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier">np.ndarray with shape (1, natom, 3)</span></dt><dd><p>Atomic coordinates in a numpy array</p>
</dd>
<dt><a class="reference internal" href="#parmed.charmm.CharmmCrdFile.positions" title="parmed.charmm.CharmmCrdFile.positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">positions</span></code></a><span class="classifier">natom x 3 distance Quantity</span></dt><dd><p>Atomic coordinates with units attached to them with the shape (natom, 3)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.charmm.CharmmCrdFile.id_format" title="parmed.charmm.CharmmCrdFile.id_format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id_format</span></code></a>(filename)</p></td>
<td><p>Identifies the file type as a CHARMM coordinate file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmCrdFile.write" title="parmed.charmm.CharmmCrdFile.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(struct, dest)</p></td>
<td><p>Writes a CHARMM coordinate file from a structure</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="parmed.charmm.CharmmCrdFile.box">
<em class="property">property </em><code class="sig-name descname">box</code><a class="headerlink" href="#parmed.charmm.CharmmCrdFile.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmCrdFile.coordinates">
<em class="property">property </em><code class="sig-name descname">coordinates</code><a class="headerlink" href="#parmed.charmm.CharmmCrdFile.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmCrdFile.id_format">
<em class="property">static </em><code class="sig-name descname">id_format</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/charmmcrds.html#CharmmCrdFile.id_format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmCrdFile.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as a CHARMM coordinate file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Name of the file to check format for</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>is_fmt</strong><span class="classifier">bool</span></dt><dd><p>True if it is a CHARMM coordinate file</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmCrdFile.positions">
<em class="property">property </em><code class="sig-name descname">positions</code><a class="headerlink" href="#parmed.charmm.CharmmCrdFile.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic coordinates with units attached to them with the shape (natom, 3)</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmCrdFile.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">struct</span></em>, <em class="sig-param"><span class="n">dest</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/charmmcrds.html#CharmmCrdFile.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmCrdFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a CHARMM coordinate file from a structure</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>struct</strong><span class="classifier"><a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.structure.Structure</span></code></a></span></dt><dd><p>The input structure to write the CHARMM coordinate file from</p>
</dd>
<dt><strong>dest</strong><span class="classifier">str or file-like object</span></dt><dd><p>The file name or file object to write the coordinate file to</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="parmed.charmm.CharmmParameterSet">
<em class="property">class </em><code class="sig-prename descclassname">parmed.charmm.</code><code class="sig-name descname">CharmmParameterSet</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="parmed.parameters.html#parmed.parameters.ParameterSet" title="parmed.parameters.ParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.parameters.ParameterSet</span></code></a>, <a class="reference internal" href="parmed.charmm.parameters.html#parmed.charmm.parameters.CharmmImproperMatchingMixin" title="parmed.charmm.parameters.CharmmImproperMatchingMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.charmm.parameters.CharmmImproperMatchingMixin</span></code></a></p>
<p>Stores a parameter set defined by CHARMM files. It stores the equivalent of
the information found in the MASS section of the CHARMM topology file
(TOP/RTF) and all of the information in the parameter files (PAR)</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*filenames</strong><span class="classifier">variable length arguments of str</span></dt><dd><p>The list of topology, parameter, and stream files to load into the
parameter set. The following file type suffixes are recognized:</p>
<blockquote>
<div><p>.rtf, .top – Residue topology file
.par, .prm – Parameter file
.str – Stream file
.inp – If “par” is in the file name, it is a parameter file. If</p>
<blockquote>
<div><p>“top” is in the file name, it is a topology file.
Otherwise, ValueError is raised.</p>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="parmed.parameters.html#parmed.parameters.ParameterSet" title="parmed.parameters.ParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.parameters.ParameterSet</span></code></a></dt><dd></dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>combining_rule</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">condense</span></code>([do_dihedrals])</p></td>
<td><p>This function goes through each of the parameter type dicts and eliminates duplicate types.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.from_parameterset" title="parmed.charmm.CharmmParameterSet.from_parameterset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_parameterset</span></code></a>(params[, copy])</p></td>
<td><p>Instantiates a CharmmParameterSet from another ParameterSet (or subclass).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.from_structure" title="parmed.charmm.CharmmParameterSet.from_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_structure</span></code></a>(struct)</p></td>
<td><p>Extracts known parameters from a Structure instance</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.load_set" title="parmed.charmm.CharmmParameterSet.load_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_set</span></code></a>([tfile, pfile, sfiles])</p></td>
<td><p>Instantiates a CharmmParameterSet from a Topology file and a Parameter file (or just a Parameter file if it has all information)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_improper_type</span></code>(a1, a2, a3, a4)</p></td>
<td><p>Matches an improper type based on atom type names</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.read_parameter_file" title="parmed.charmm.CharmmParameterSet.read_parameter_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_parameter_file</span></code></a>(pfile[, comments])</p></td>
<td><p>Reads all of the parameters from a parameter file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.read_stream_file" title="parmed.charmm.CharmmParameterSet.read_stream_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_stream_file</span></code></a>(sfile)</p></td>
<td><p>Reads RTF and PAR sections from a stream file and dispatches the sections to read_topology_file or read_parameter_file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.read_topology_file" title="parmed.charmm.CharmmParameterSet.read_topology_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_topology_file</span></code></a>(tfile)</p></td>
<td><p>Reads _only_ the atom type definitions from a topology file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">typeify_templates</span></code>()</p></td>
<td><p>Assign atom types to atom names in templates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmParameterSet.write" title="parmed.charmm.CharmmParameterSet.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>([top, par, str])</p></td>
<td><p>Write a CHARMM parameter set to a file</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.from_parameterset">
<em class="property">classmethod </em><code class="sig-name descname">from_parameterset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.from_parameterset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.from_parameterset" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a CharmmParameterSet from another ParameterSet (or
subclass). The main thing this feature is responsible for is converting
lower-case atom type names into all upper-case and decorating the name
to ensure each atom type name is unique.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>params</strong><span class="classifier"><a class="reference internal" href="parmed.parameters.html#parmed.parameters.ParameterSet" title="parmed.parameters.ParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.parameters.ParameterSet</span></code></a></span></dt><dd><p>ParameterSet containing the list of parameters to be converted to a
CHARMM-compatible set</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the returned parameter set is a deep copy of <code class="docutils literal notranslate"><span class="pre">params</span></code>. If
False, the returned parameter set is a shallow copy, and the
original set may be modified if any lower-case atom type names are
present. Default is False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>new_params</strong><span class="classifier">CharmmParameterSet</span></dt><dd><p>The parameter set whose atom type names are converted to all
upper-case</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.from_structure">
<em class="property">classmethod </em><code class="sig-name descname">from_structure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">struct</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.from_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts known parameters from a Structure instance</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>struct</strong><span class="classifier"><a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.structure.Structure</span></code></a></span></dt><dd><p>The parametrized <code class="docutils literal notranslate"><span class="pre">Structure</span></code> instance from which to extract
parameters into a ParameterSet</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>params</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterSet</span></code></span></dt><dd><p>The parameter set with all parameters defined in the Structure</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters here are copies of the ones in the Structure, so
modifying the generated ParameterSet will have no effect on <code class="docutils literal notranslate"><span class="pre">struct</span></code>.
Furthermore, the <em>first</em> occurrence of each parameter will be used. If
future ones differ, they will be silently ignored, since this is
expected behavior in some instances (like with Gromacs topologies in the
ff99sb-ildn force field).</p>
<p>Dihedrals are a little trickier. They can be multi-term, which can be
represented either as a <em>single</em> entry in dihedrals with a type of
DihedralTypeList or multiple entries in dihedrals with a DihedralType
parameter type. In this case, the parameter is constructed from either
the first DihedralTypeList found or the first DihedralType of each
periodicity found if no matching DihedralTypeList is found.</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.load_set">
<em class="property">classmethod </em><code class="sig-name descname">load_set</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pfile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sfiles</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.load_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.load_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a CharmmParameterSet from a Topology file and a Parameter
file (or just a Parameter file if it has all information)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tfile</strong><span class="classifier">str</span></dt><dd><p>The name of the Topology (RTF/TOP) file to parse</p>
</dd>
<dt><strong>pfile</strong><span class="classifier">str</span></dt><dd><p>The name of the Parameter (PAR/PRM) file to parse</p>
</dd>
<dt><strong>sfiles</strong><span class="classifier">list(str)</span></dt><dd><p>Iterable of stream (STR) file names</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>New CharmmParameterSet populated with parameters found in the provided</dt><dd></dd>
<dt>files</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The RTF file is read first (if provided), followed by the PAR file,
followed by the list of stream files (in the order they are provided).
Parameters in each stream file will overwrite those that came before (or
simply append to the existing set if they are different)</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.read_parameter_file">
<code class="sig-name descname">read_parameter_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pfile</span></em>, <em class="sig-param"><span class="n">comments</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.read_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.read_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads all of the parameters from a parameter file. Versions 36 and
later of the CHARMM force field files have an ATOMS section defining
all of the atom types.  Older versions need to load this information
from the RTF/TOP files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pfile</strong><span class="classifier">str or list of lines</span></dt><dd><p>Name of the CHARMM parameter file to read or list of lines to parse
as a file</p>
</dd>
<dt><strong>comments</strong><span class="classifier">list of str, optional</span></dt><dd><p>List of comments on each of the pfile lines (if pfile is a list of
lines)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The atom types must all be loaded by the end of this routine.  Either
supply a PAR file with atom definitions in them or read in a RTF/TOP
file first. Failure to do so will result in a raised RuntimeError.</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.read_stream_file">
<code class="sig-name descname">read_stream_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.read_stream_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.read_stream_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads RTF and PAR sections from a stream file and dispatches the
sections to read_topology_file or read_parameter_file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sfile</strong><span class="classifier">str or CharmmStreamFile</span></dt><dd><p>Stream file to parse</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.read_topology_file">
<code class="sig-name descname">read_topology_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.read_topology_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.read_topology_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads _only_ the atom type definitions from a topology file. This is
unnecessary for versions 36 and later of the CHARMM force field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tfile</strong><span class="classifier">str</span></dt><dd><p>Name of the CHARMM topology file to read</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmParameterSet.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">top</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">par</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">str</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/parameters.html#CharmmParameterSet.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmParameterSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a CHARMM parameter set to a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>top</strong><span class="classifier">str or file-like object, optional</span></dt><dd><p>If provided, the atom types will be written to this file in RTF
format.</p>
</dd>
<dt><strong>par</strong><span class="classifier">str or file-like object, optional</span></dt><dd><p>If provided, the parameters will be written to this file in PAR
format. Either this or the <code class="docutils literal notranslate"><span class="pre">str</span></code> argument <em>must</em> be provided</p>
</dd>
<dt><strong>str</strong><span class="classifier">str or file-like object, optional</span></dt><dd><p>If provided, the atom types and parameters will be written to this
file as separate RTF and PAR cards that can be read as a CHARMM
stream file. Either this or the <code class="docutils literal notranslate"><span class="pre">par</span></code> argument <em>must</em> be provided</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>ValueError if both par and str are None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="parmed.charmm.CharmmPsfFile">
<em class="property">class </em><code class="sig-prename descclassname">parmed.charmm.</code><code class="sig-name descname">CharmmPsfFile</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/psf.html#CharmmPsfFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmPsfFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.structure.Structure</span></code></a></p>
<p>A chemical <code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code> instantiated from CHARMM files.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>psf_name</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the PSF file (it must exist)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl>
<dt><strong>IOError</strong><span class="classifier">If file <code class="docutils literal notranslate"><span class="pre">psf_name</span></code> does not exist</span></dt><dd></dd>
<dt><strong>CharmmPsfError</strong><span class="classifier">If any parsing errors are encountered</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>box</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">box_vectors</span></code></dt><dd><p>3, 3-element tuple of unit cell vectors that are Quantity objects of</p>
</dd>
<dt><strong>combining_rule</strong></dt><dd></dd>
<dt><strong>coordinates</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">positions</span></code></dt><dd><p>A list of 3-element Quantity tuples of dimension length representing the atomic positions for every atom in the system.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">topology</span></code></dt><dd><p>The OpenMM Topology object.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocities</span></code></dt><dd><p>A (natom, 3)-shape numpy array with atomic velocities for every atom in</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">view</span></code></dt><dd><p>Returns an indexable object that can be indexed like a standard</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atom</span></code>(atom, resname, resnum[, chain, …])</p></td>
<td><p>Adds a new atom to the Structure, adding a new residue to <cite>residues</cite> if it has a different name or number as the last residue added and adding it to the <cite>atoms</cite> list.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_atom_to_residue</span></code>(atom, residue)</p></td>
<td><p>Adds a new atom to the Structure at the end if the given residue</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_bonds</span></code>(*reslibs)</p></td>
<td><p>Assigns bonds to all atoms based on the provided residue template libraries.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmPsfFile.clear_cmap" title="parmed.charmm.CharmmPsfFile.clear_cmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_cmap</span></code></a>()</p></td>
<td><p>Clear the cmap list to prevent any CMAP parameters from being used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code>(cls[, split_dihedrals])</p></td>
<td><p>Makes a copy of the current structure as an instance of a specified subclass</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmPsfFile.createSystem" title="parmed.charmm.CharmmPsfFile.createSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">createSystem</span></code></a>([params])</p></td>
<td><p>Creates an OpenMM System object from the CHARMM PSF file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.charmm.CharmmPsfFile.from_structure" title="parmed.charmm.CharmmPsfFile.from_structure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_structure</span></code></a>(struct[, copy])</p></td>
<td><p>Instantiates a CharmmPsfFile from an input Structure instance.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_box</span></code>([frame])</p></td>
<td><p>In some cases, multiple conformations may be stored in the Structure.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coordinates</span></code>([frame])</p></td>
<td><p>In some cases, multiple conformations may be stored in the Structure.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_NBFIX</span></code>()</p></td>
<td><p>Returns whether or not any pairs of atom types have their LJ interactions modified by an NBFIX definition</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_changed</span></code>()</p></td>
<td><p>Determines if any of the topology has changed for this structure</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">join_dihedrals</span></code>()</p></td>
<td><p>Joins multi-term torsions into a single term and makes all of the parameters DihedralTypeList instances.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_dataframe</span></code>(df)</p></td>
<td><p>Loads atomic properties from an input DataFrame</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#parmed.charmm.CharmmPsfFile.load_parameters" title="parmed.charmm.CharmmPsfFile.load_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_parameters</span></code></a>(parmset[, copy_parameters])</p></td>
<td><p>Loads parameters from a parameter set that was loaded via CHARMM RTF, PAR, and STR files.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_add_constraints</span></code>(system, constraints, …)</p></td>
<td><p>Adds constraints to a given system</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_angle_force</span></code>([constraints, …])</p></td>
<td><p>Creates an OpenMM HarmonicAngleForce object (or AmoebaAngleForce if the angles are for an Amoeba-parametrized system)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_bond_force</span></code>([constraints, rigidWater, …])</p></td>
<td><p>Creates an OpenMM Bond Force object (or AmoebaBondForce if the bonds are for an Amoeba-parametrized system)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_cmap_force</span></code>()</p></td>
<td><p>Creates the OpenMM CMAP torsion force</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_dihedral_force</span></code>([split])</p></td>
<td><p>Creates the OpenMM PeriodicTorsionForce modeling dihedrals</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_gbsa_force</span></code>(implicitSolvent[, …])</p></td>
<td><p>Creates a Generalized Born force for running implicit solvent calculations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_improper_force</span></code>()</p></td>
<td><p>Creates the OpenMM improper torsion force (quadratic bias)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_nonbonded_force</span></code>([nonbondedMethod, …])</p></td>
<td><p>Creates the OpenMM NonbondedForce instance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_out_of_plane_bend_force</span></code>()</p></td>
<td><p>Creates the Amoeba out-of-plane bend force</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_pi_torsion_force</span></code>()</p></td>
<td><p>Creates the Amoeba pi-torsion force</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_rb_torsion_force</span></code>()</p></td>
<td><p>Creates the OpenMM RBTorsionForce for Ryckaert-Bellemans torsions</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_set_virtual_sites</span></code>(system)</p></td>
<td><p>Sets the virtual sites in a given OpenMM <cite>System</cite> object from the extra points defined in this system</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_stretch_bend_force</span></code>()</p></td>
<td><p>Create the OpenMM Amoeba stretch-bend force for this system</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_torsion_torsion_force</span></code>()</p></td>
<td><p>Create the OpenMM Amoeba coupled-torsion (CMAP) force</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_trigonal_angle_force</span></code>()</p></td>
<td><p>Creates the Amoeba trigonal-angle force</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">omm_urey_bradley_force</span></code>()</p></td>
<td><p>Creates the OpenMM Urey-Bradley force</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">prune_empty_terms</span></code>()</p></td>
<td><p>Looks through all of the topological lists and gets rid of terms in which at least one of the atoms is None or has an <cite>idx</cite> attribute set to -1 (indicating that it has been removed from the <cite>atoms</cite> atom list)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(fname[, format, overwrite])</p></td>
<td><p>Saves the current Structure in the requested file format.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code>()</p></td>
<td><p>Split the current Structure into separate Structure instances for each unique molecule.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">strip</span></code>(selection)</p></td>
<td><p>Deletes a subset of the atoms corresponding to an atom-based selection.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dataframe</span></code>()</p></td>
<td><p>Generates a DataFrame from the current Structure’s atomic properties</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">unchange</span></code>()</p></td>
<td><p>Toggles all lists so that they do not indicate any changes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_dihedral_exclusions</span></code>()</p></td>
<td><p>Nonbonded exclusions and exceptions have the following priority:</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize</span></code>(*args, **kwargs)</p></td>
<td><p>Use nglview for visualization.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_cif</span></code>(dest[, renumber, coordinates, …])</p></td>
<td><p>Write a PDB file from the current Structure instance</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_pdb</span></code>(dest[, renumber, coordinates, …])</p></td>
<td><p>Write a PDB file from a Structure instance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_psf</span></code>(dest[, vmd])</p></td>
<td><p>Writes a PSF file from the stored molecule</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="parmed.charmm.CharmmPsfFile.clear_cmap">
<code class="sig-name descname">clear_cmap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/psf.html#CharmmPsfFile.clear_cmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmPsfFile.clear_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the cmap list to prevent any CMAP parameters from being used</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmPsfFile.createSystem">
<code class="sig-name descname">createSystem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/psf.html#CharmmPsfFile.createSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmPsfFile.createSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an OpenMM System object from the CHARMM PSF file. This is a
shortcut for calling <cite>load_parameters</cite> followed by
Structure.createSystem. If params is not None, <cite>load_parameters</cite> will be
called on that parameter set, and Structure.createSystem will be called
with the remaining args and kwargs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">CharmmParameterSet=None</span></dt><dd><p>If not None, this parameter set will be loaded</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="parmed.structure.html#parmed.structure.Structure.createSystem" title="parmed.structure.Structure.createSystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parmed.structure.Structure.createSystem()</span></code></a></dt><dd><p>In addition to <cite>params</cite>, this method also takes all arguments for <a class="reference internal" href="parmed.structure.html#parmed.structure.Structure.createSystem" title="parmed.structure.Structure.createSystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parmed.structure.Structure.createSystem()</span></code></a></p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmPsfFile.from_structure">
<em class="property">classmethod </em><code class="sig-name descname">from_structure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">struct</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/psf.html#CharmmPsfFile.from_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmPsfFile.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a CharmmPsfFile from an input Structure instance. This
method makes sure all atom types have uppercase-only names</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>struct</strong><span class="classifier"><a class="reference internal" href="../../structobj/parmed.structure.Structure.html#parmed.structure.Structure" title="parmed.structure.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">parmed.structure.Structure</span></code></a></span></dt><dd><p>The input structure to convert to a CharmmPsfFile instance</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, a copy of all items are made. Otherwise, the resulting
CharmmPsfFile is a shallow copy</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>psf</strong><span class="classifier"><a class="reference internal" href="../../charmmobj/parmed.charmm.CharmmPsfFile.html#parmed.charmm.CharmmPsfFile" title="parmed.charmm.CharmmPsfFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharmmPsfFile</span></code></a></span></dt><dd><p>CHARMM PSF file</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError if the functional form is not recognized or cannot be</dt><dd></dd>
<dt>implemented through the PSF and parameter/stream files</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If copy is False, the original object may have its atom type names
changed if any of them have lower-case letters</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmPsfFile.load_parameters">
<code class="sig-name descname">load_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parmset</span></em>, <em class="sig-param"><span class="n">copy_parameters</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/psf.html#CharmmPsfFile.load_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmPsfFile.load_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads parameters from a parameter set that was loaded via CHARMM RTF,
PAR, and STR files.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>parmset</strong><span class="classifier"><a class="reference internal" href="../../charmmobj/parmed.charmm.CharmmParameterSet.html#parmed.charmm.CharmmParameterSet" title="parmed.charmm.CharmmParameterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharmmParameterSet</span></code></a></span></dt><dd><p>List of all parameters</p>
</dd>
<dt><strong>copy_parameters</strong><span class="classifier">bool, optional, default=True</span></dt><dd><p>If False, parmset will not be copied.</p>
<p>Not copying parmset will cause ParameterSet and Structure to share
references to types.  If you modify the original parameter set, the
references in Structure list_types will be silently modified.
However, if you change any reference in the parameter set, then that
reference will no longer be shared with structure.</p>
<p>Example where the reference in ParameterSet is changed. The
following will NOT modify the parameters in the psf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psf</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">parmset</span><span class="p">,</span> <span class="n">copy_parameters</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">parmset</span><span class="o">.</span><span class="n">angle_types</span><span class="p">[(</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="n">a3</span><span class="s1">&#39;)] = AngleType(1, 2)</span>
</pre></div>
</div>
<p>The following WILL change the parameter in the psf because the
reference has not been changed in <code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psf</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">parmset</span><span class="p">,</span> <span class="n">copy_parameters</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">parmset</span><span class="o">.</span><span class="n">angle_types</span><span class="p">[(</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;a3&#39;</span><span class="p">)]</span>
<span class="n">a</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">a</span><span class="o">.</span><span class="n">theteq</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>Extra care should be taken when trying this with dihedral_types.
Since dihedral_type is a Fourier sequence, ParameterSet stores
DihedralType for every term in DihedralTypeList. Therefore, the
example below will STILL modify the type in the <code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code>
list_types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parmset</span><span class="o">.</span><span class="n">dihedral_types</span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">DihedralType</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This assigns a new instance of DihedralType to an existing
DihedralTypeList that ParameterSet and Structure are tracking and
the shared reference is NOT changed.</p>
<p>Use with caution!</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>ParameterError if any parameters cannot be found</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If any dihedral or improper parameters cannot be found, I will try
inserting wildcards (at either end for dihedrals and as the two
central atoms in impropers) and see if that matches.  Wild-cards will
apply ONLY if specific parameters cannot be found.</p></li>
<li><p>This method will expand the dihedrals attribute by adding a separate
Dihedral object for each term for types that have a multi-term
expansion</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="parmed.charmm.CharmmRstFile">
<em class="property">class </em><code class="sig-prename descclassname">parmed.charmm.</code><code class="sig-name descname">CharmmRstFile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/charmmcrds.html#CharmmRstFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmRstFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads and parses data, velocities and coordinates from a CHARMM restart
file (.rst) of file name ‘fname’ into class attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fname</strong><span class="classifier">str</span></dt><dd><p>Name of the restart file to parse</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>natom</strong><span class="classifier">int</span></dt><dd><p>Number of atoms in the system</p>
</dd>
<dt><strong>resname</strong><span class="classifier">list of str</span></dt><dd><p>Names of all residues in the system</p>
</dd>
<dt><strong>coordinates</strong><span class="classifier">np.ndarray shape(1, natom, 3)</span></dt><dd><p>List of all coordinates in the format [x1, y1, z1, x2, y2, z2, …]</p>
</dd>
<dt><strong>coordinatesold</strong><span class="classifier">np.ndarray shape(1, natom, 3)</span></dt><dd><p>List of all old coordinates in the format [x1, y1, z1, x2, y2, z2, …]</p>
</dd>
<dt><a class="reference internal" href="#parmed.charmm.CharmmRstFile.velocities" title="parmed.charmm.CharmmRstFile.velocities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocities</span></code></a><span class="classifier">np.ndarray shape(1, natom, 3)</span></dt><dd><p>Atomic velocities in Angstroms/picoseconds</p>
</dd>
<dt><a class="reference internal" href="#parmed.charmm.CharmmRstFile.positions" title="parmed.charmm.CharmmRstFile.positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">positions</span></code></a><span class="classifier">natom x 3 distance Quantity</span></dt><dd><p>Atomic positions with units</p>
</dd>
<dt><a class="reference internal" href="#parmed.charmm.CharmmRstFile.positionsold" title="parmed.charmm.CharmmRstFile.positionsold"><code class="xref py py-obj docutils literal notranslate"><span class="pre">positionsold</span></code></a><span class="classifier">natom x 3 distance Quantity</span></dt><dd><p>Old atomic positions with units</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#parmed.charmm.CharmmRstFile.id_format" title="parmed.charmm.CharmmRstFile.id_format"><code class="xref py py-obj docutils literal notranslate"><span class="pre">id_format</span></code></a>(filename)</p></td>
<td><p>Identifies the file type as a CHARMM restart file</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>scan</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.box">
<em class="property">property </em><code class="sig-name descname">box</code><a class="headerlink" href="#parmed.charmm.CharmmRstFile.box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.coordinates">
<em class="property">property </em><code class="sig-name descname">coordinates</code><a class="headerlink" href="#parmed.charmm.CharmmRstFile.coordinates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.coordinatesold">
<em class="property">property </em><code class="sig-name descname">coordinatesold</code><a class="headerlink" href="#parmed.charmm.CharmmRstFile.coordinatesold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.id_format">
<em class="property">static </em><code class="sig-name descname">id_format</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/charmmcrds.html#CharmmRstFile.id_format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmRstFile.id_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the file type as a CHARMM restart file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Name of the file to check format for</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>is_fmt</strong><span class="classifier">bool</span></dt><dd><p>True if it is a CHARMM restart file</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.positions">
<em class="property">property </em><code class="sig-name descname">positions</code><a class="headerlink" href="#parmed.charmm.CharmmRstFile.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic positions with units</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.positionsold">
<em class="property">property </em><code class="sig-name descname">positionsold</code><a class="headerlink" href="#parmed.charmm.CharmmRstFile.positionsold" title="Permalink to this definition">¶</a></dt>
<dd><p>Old atomic positions with units</p>
</dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.scan">
<code class="sig-name descname">scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">str</span></em>, <em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/charmm/charmmcrds.html#CharmmRstFile.scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.charmm.CharmmRstFile.scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="parmed.charmm.CharmmRstFile.velocities">
<em class="property">property </em><code class="sig-name descname">velocities</code><a class="headerlink" href="#parmed.charmm.CharmmRstFile.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic velocities in Angstroms/picoseconds</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Jason Swails

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>