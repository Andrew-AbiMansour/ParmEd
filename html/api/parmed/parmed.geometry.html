

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>parmed.geometry module &mdash; ParmEd  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> ParmEd
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.3319.g7a6168d
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../topologyobjects.html">Core classes used to represent topologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structure.html">The core Structure class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dimensional_analysis.html">Working with units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../readwrite.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../amber.html">The Amber file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../charmm.html">The CHARMM file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gromacs.html">The GROMACS file classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rosetta.html">PyRosetta Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed.html">Using <code class="docutils literal notranslate"><span class="pre">parmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed.html#using-xparmed">Using <code class="docutils literal notranslate"><span class="pre">xparmed</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parmed_api.html">The ParmEd API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openmm.html">OpenMM Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualization.html">Visualization Functionality</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ParmEd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>parmed.geometry module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/parmed/parmed.geometry.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-parmed.geometry">
<span id="parmed-geometry-module"></span><h1>parmed.geometry module<a class="headerlink" href="#module-parmed.geometry" title="Permalink to this headline">¶</a></h1>
<p>This module contains the functionality for carrying out geometrical calculations
for molecules and molecular systems</p>
<p>Author: Jason Swails
Contributors:</p>
<p>Copyright (C) 2014 - 2015  Jason Swails</p>
<p>This program is free software; you can redistribute it and/or modify it under
the terms of the GNU Lesser General Public License as published by the Free
Software Foundation; either version 2 of the License, or (at your option) any
later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
59 Temple Place - Suite 330
Boston, MA 02111-1307, USA.</p>
<dl class="py function">
<dt id="parmed.geometry.angle">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a1</span></em>, <em class="sig-param"><span class="n">a2</span></em>, <em class="sig-param"><span class="n">a3</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cartesian angle between three atoms. Ignores periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a1, a2, a3</strong><span class="classifier">Atom or collection of 3 coordinates</span></dt><dd><p>The three atoms between whom the angle should be calculated (with a2
being the central atoms)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ang</strong><span class="classifier">float</span></dt><dd><p>The angle between the vectors a1-a2 and a2-a3 in degrees</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>TypeError if a1, a2, or a3 are not Atom or iterable</dt><dd></dd>
<dt>ValueError if a1, a2, or a3 are iterable, but do not have exactly 3 items</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is done in pure Python, so it should not be used for large numbers of
distance calculations. For that, use numpy-vectorized routines and the numpy
coordinate arrays</p>
</dd></dl>

<dl class="py function">
<dt id="parmed.geometry.box_lengths_and_angles_to_vectors">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">box_lengths_and_angles_to_vectors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">alpha</span></em>, <em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">gamma</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#box_lengths_and_angles_to_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.box_lengths_and_angles_to_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the lengths of the unit cell vectors and the angles
between them and returns 3 unit cell vectors satisfying those dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">double (or length Quantity)</span></dt><dd><p>Length of the first unit cell vector</p>
</dd>
<dt><strong>b</strong><span class="classifier">double (or length Quantity)</span></dt><dd><p>Length of the second unit cell vector</p>
</dd>
<dt><strong>c</strong><span class="classifier">double (or length Quantity)</span></dt><dd><p>Length of the third unit cell vector</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">double (or angle Quantity)</span></dt><dd><p>Angle between vectors b and c</p>
</dd>
<dt><strong>beta</strong><span class="classifier">double (or angle Quantity)</span></dt><dd><p>Angle between vectors a and c</p>
</dd>
<dt><strong>gamma</strong><span class="classifier">double (or angle Quantity)</span></dt><dd><p>Angle between vectors a and b</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>list Quantity, list Quantity, list Quantity</dt><dd><p>The 3, 3-element vectors as quantities with dimension length</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The unit cell lengths are assumed to be Angstroms if no explicit unit is
given. The angles are assumed to be degrees</p>
</dd></dl>

<dl class="py function">
<dt id="parmed.geometry.box_vectors_to_lengths_and_angles">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">box_vectors_to_lengths_and_angles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">c</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#box_vectors_to_lengths_and_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.box_vectors_to_lengths_and_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the lengths of the unit cell vectors and the angles
between them and returns 3 unit cell vectors satisfying those dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">collection of 3 floats (or length Quantity)</span></dt><dd><p>The first unit cell vector</p>
</dd>
<dt><strong>b</strong><span class="classifier">collection of 3 floats (or length Quantity)</span></dt><dd><p>The second unit cell vector</p>
</dd>
<dt><strong>c</strong><span class="classifier">collection of 3 floats (or length Quantity)</span></dt><dd><p>The third unit cell vector</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>(a, b, c), (alpha, beta, gamma)</dt><dd><p>Two tuples, the first is the 3 unit cell vector lengths as
length-dimension Quantity objects and the second is the set of angles
between the unit cell vectors as angle-dimension Quantity objects</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The unit cell lengths are assumed to be Angstroms if no explicit unit is
given.</p>
</dd></dl>

<dl class="py function">
<dt id="parmed.geometry.center_of_mass">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">center_of_mass</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coordinates</span></em>, <em class="sig-param"><span class="n">masses</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#center_of_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the center of mass of a group of coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>coordinates</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Coordinate array</p>
</dd>
<dt><strong>masses</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Array of masses</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>COM</dt><dd><p>np.ndarray of shape (3,) identifying the cartesian center of mass</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method <em>requires</em> that the parameters be passed in as numpy arrays.
AttributeError’s will ensue if this is not the case. Also, coordinates must
be able to be reshaped to (len(masses), 3), or ValueError’s will ensue</p>
</dd></dl>

<dl class="py function">
<dt id="parmed.geometry.dihedral">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">dihedral</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a1</span></em>, <em class="sig-param"><span class="n">a2</span></em>, <em class="sig-param"><span class="n">a3</span></em>, <em class="sig-param"><span class="n">a4</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#dihedral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the angle between three vectors made up of four points (all three
vectors share one point with one other vector)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a1, a2, a3, a4</strong><span class="classifier">Atom or collection of 4 coordinates</span></dt><dd><p>The four atoms between whom the torsion angle should be calculated (with
a1 and a4 being the two end-point atoms not shared between two vectors)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>dihed</strong><span class="classifier">float</span></dt><dd><p>The measured dihedral between the 4 points in degrees</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="parmed.geometry.distance2">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">distance2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a1</span></em>, <em class="sig-param"><span class="n">a2</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#distance2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.distance2" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cartesian distance between two atoms. Ignores periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a1, a2</strong><span class="classifier">Atom or collection of 3 coordinates</span></dt><dd><p>The two atoms between whom the distance should be calculated</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>d2</strong><span class="classifier">float</span></dt><dd><p>The square of the distance between the two atoms</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>TypeError if a1 or a2 are not Atom or iterable</dt><dd></dd>
<dt>ValueError if a1 or a2 are iterable, but do not have exactly 3 items</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is done in pure Python, so it should not be used for large numbers of
distance calculations. For that, use numpy-vectorized routines and the numpy
coordinate arrays</p>
</dd></dl>

<dl class="py function">
<dt id="parmed.geometry.reduce_box_vectors">
<code class="sig-prename descclassname">parmed.geometry.</code><code class="sig-name descname">reduce_box_vectors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em>, <em class="sig-param"><span class="n">c</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/parmed/geometry.html#reduce_box_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#parmed.geometry.reduce_box_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>This function puts three unit cell vectors in a reduced form where a is
“mostly” in x, b is “mostly” in y, and c is “mostly” in z. This form is
necessary for some programs (notably OpenMM and Gromacs)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>a</strong><span class="classifier">3-element collection of float</span></dt><dd><p>First unit cell vector</p>
</dd>
<dt><strong>b</strong><span class="classifier">3-element collection of float</span></dt><dd><p>Second unit cell vector</p>
</dd>
<dt><strong>c</strong><span class="classifier">3-element collection of float</span></dt><dd><p>Third unit cell vector</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>red_a, red_b, red_c</strong><span class="classifier">Vec3, Vec3, Vec3</span></dt><dd><p>The reduced unit cell vectors in units of angstroms</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The implementation here is taken from the OpenMM Python application layer
written by Peter Eastman</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015, Jason Swails

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>